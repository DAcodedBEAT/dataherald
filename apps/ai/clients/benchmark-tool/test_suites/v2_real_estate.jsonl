{"nl_question":"what was the most expensive zip code to rent in Los Angeles county in May 2022?", "sql": "select location_name, metric_value from renthub_median_rent where dh_county_name = 'Los Angeles' and period_start='2022-05-01' and geo_type='zip' order by metric_value desc", "db":"v2_real_estate"}
{"nl_question":"what was the median home sale price in Califronia in Q1 2021?","sql":"select location_name, metric_value, period_end, property_type from redfin_median_sale_price rmsp where geo_type = 'state' and location_name='California' and property_type = 'All Residential' and period_start between '2021-01-01' and '2021-03-01' order by period_end " , "db":"v2_real_estate"}
{"nl_question":"How many townhomes have been sold in Austin, TX this year?", "sql":"select sum(metric_value), location_name, dh_state_name from redfin_homes_sold rhs where geo_type='city' and location_name ='Austin' and property_type='Townhouse' and '2023-01-1' <= period_start group by location_name , dh_state_name ", "db":"v2_real_estate"}
{"nl_question":"Did property prices increase or descrease in the US in 2018?", "sql":"select metric_value, location_name, period_start from redfin_median_list_price rmlp where geo_type ='national' and period_start between '2020-1-1' and '2020-12-01' order by period_start ", "db":"v2_real_estate"}
{"nl_question":"compare home prices in los angeles vs austin since 2022", "sql":"Select metric_value, period_end, location_name, dh_state_name, property_type from redfin_median_sale_price where geo_type='city' and (location_name='Los Angeles' and dh_state_name='California' and period_end between '2022-01-31' and '2023-05-31' and property_type = 'All Residential') or (location_name = 'Austin' and dh_state_name='Texas' and period_end between '2022-01-31' and '2023-05-31' and property_type = 'All Residential')   order by period_end", "db":"v2_real_estate"}
{"nl_question":"average home price 90405", "sql":"select metric_value, property_type, location_name, period_start , period_end from redfin_median_list_price rmlp where geo_type='zip' and location_name = '90405' order by period_start desc limit 30", "db":"v2_real_estate"}
{"nl_question":"how many homes were sold in orange county in 2022 broken down by property type", "sql":"select property_type, SUM(metric_value), period_type from redfin_homes_sold rhs where geo_type='county' and location_name='Orange County' and dh_state_name='California' and period_end between '2022-01-31' and '2022-12-31' group by property_type, period_type", "db":"v2_real_estate"}
{"nl_question":"rents in santa monica 2021 till jan 2023", "sql":"select metric_value, period_start, period_end, location_name, property_type from renthub_median_rent where geo_type = 'city' and location_name = 'Santa Monica' and dh_state_name = 'California' and property_type = 'All Residential' and period_start between '2021-01-01' and '2023-01-01' order by period_start", "db":"v2_real_estate"}
{"nl_question": "What is the median rent price for each property type in Los angeles city?", "sql": " SELECT property_type,location_name,metric_value  FROM public.renthub_median_rent WHERE true and geo_type='city' and property_type='All Residential'AND dh_state_name = 'California'      AND dh_place_name = 'Los Angeles' ORDER BY period_end DESC, metric_value DESC   LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "What is the median sale price for each property type in California state?",  "sql": " SELECT property_type,location_name,metric_value  FROM public.redfin_median_sale_price rmsp   WHERE true and geo_type='state' and property_type='All Residential' and dh_state_name='California' ORDER BY period_end DESC, metric_value DESC   LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "What is the total number of listings for each property type in New York city?", "sql": " SELECT property_type,location_name,metric_value  FROM public.redfin_inventory ri  WHERE true and geo_type='city' and property_type='All Residential' and dh_state_name='New York' and dh_place_name='New York'  ORDER BY period_end DESC, metric_value DESC   LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "How many new listings are there for each property type in the Orange county?", "sql": " SELECT property_type,location_name,metric_value  FROM public.redfin_new_listings ri  WHERE true and geo_type='county'  and location_name='Orange County'  and dh_state_name='California' ORDER BY period_end DESC, metric_value DESC   LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "Which city has the highest median sale price overall in Orange County, California?", "sql": " SELECT location_name,metric_value FROM public.redfin_median_sale_price WHERE true and geo_type='city' and dh_county_name= 'Orange County' and dh_state_name='California' ORDER BY period_end DESC, metric_value DESC   LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "Which county has the highest median rent price overall in Florida?", "sql": " SELECT location_name,metric_value FROM public.renthub_median_rent WHERE true and geo_type='county' and dh_state_name='Florida' ORDER BY period_end DESC, metric_value DESC   LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "Which ZIP Code has the largest inventory overall in Chicago?", "sql": " SELECT location_name,metric_value FROM public.redfin_inventory WHERE true and geo_type='zip' and dh_place_name='Chicago' ORDER BY period_end DESC, metric_value DESC   LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "Which State has the largest numer of new inventory overall?",  "sql": " SELECT location_name,metric_value FROM public.redfin_new_listings WHERE true and geo_type='state' ORDER BY period_end DESC, metric_value DESC   LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "Which county has the lowest median sale price overall in Florida?", "sql": " SELECT location_name,metric_value FROM public.redfin_median_sale_price WHERE true and geo_type='county' and dh_state_name='Florida' ORDER BY period_end DESC, metric_value   LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "Which city has the lowest median rent price overall in Orange county?", "sql": " SELECT location_name,metric_value FROM public.renthub_median_rent WHERE true and geo_type='city' and dh_state_name='California' and dh_county_name= 'Orange' ORDER BY period_end DESC, metric_value   LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "Which State has the lowest inventory number overall?", "sql": " SELECT location_name,metric_value FROM public.redfin_inventory WHERE true and geo_type='state' ORDER BY period_end DESC, metric_value DESC   LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "Which city has the lowest number of new listings overall in Ohio?", "sql": " SELECT location_name,metric_value FROM public.redfin_new_listings WHERE true and geo_type='city' and dh_state_name='Ohio' ORDER BY period_end DESC, metric_value DESC   LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "which is the city with the highest change in the median rent price in Texas over the last year?", "sql": "WITH date_range AS (   SELECT    MAX(period_end) - INTERVAL '0 months' AS period_end,    MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.renthub_median_rent   WHERE dh_place_name <> '-' AND property_type = 'All Residential'),data AS (   SELECT    location_name,    metric_value AS median_price,    period_end   FROM public.renthub_median_rent   WHERE geo_type = 'city'    AND property_type = 'All Residential'    AND dh_state_name = 'Texas'    AND (period_end = ( SELECT period_end  FROM date_range)         OR period_end = ( SELECT period_beg  FROM date_range))) SELECT  cd.location_name,  ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = ( SELECT period_end  FROM date_range)  AND ld.period_end = ( SELECT period_beg  FROM date_range) ORDER BY 2 DESC LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "which is the city with the highest change in the median sale price in North Carolina over the last year?", "sql": "WITH date_range AS (   SELECT    MAX(period_end) - INTERVAL '0 months' AS period_end,    MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.redfin_median_sale_price   WHERE dh_place_name <> '-' AND property_type = 'All Residential'),data AS (   SELECT    location_name,    metric_value AS median_price,    period_end   FROM public.redfin_median_sale_price   WHERE geo_type = 'city'    AND property_type = 'All Residential'    AND dh_state_name = 'North Carolina'    AND (period_end = ( SELECT period_end  FROM date_range)         OR period_end = ( SELECT period_beg  FROM date_range))) SELECT  cd.location_name,  ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = ( SELECT period_end  FROM date_range)  AND ld.period_end = ( SELECT period_beg  FROM date_range) ORDER BY 2 DESC LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "which is the city with the highest change in the inventory of Real Estate in Illinois over the last year?", "sql": "WITH date_range AS (   SELECT    MAX(period_end) - INTERVAL '0 months' AS period_end,    MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.redfin_inventory   WHERE dh_place_name <> '-' AND property_type = 'All Residential'),data AS (   SELECT    location_name,    metric_value AS median_price,    period_end   FROM public.redfin_inventory   WHERE geo_type = 'city'    AND property_type = 'All Residential'    AND dh_state_name = 'Illinois'    AND (period_end = ( SELECT period_end  FROM date_range)         OR period_end = ( SELECT period_beg  FROM date_range))) SELECT  cd.location_name,  ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = ( SELECT period_end  FROM date_range)  AND ld.period_end = ( SELECT period_beg  FROM date_range) ORDER BY 2 DESC LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "which is the city with the highest change in the number of new listings of Real Estate in Texas over the last year?", "sql": "WITH date_range AS (   SELECT    MAX(period_end) - INTERVAL '0 months' AS period_end,    MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.redfin_new_listings   WHERE dh_place_name <> '-' AND property_type = 'All Residential'),data AS (   SELECT    location_name,    metric_value AS median_price,    period_end   FROM public.redfin_new_listings   WHERE geo_type = 'city'    AND property_type = 'All Residential'    AND dh_state_name = 'Texas'    AND (period_end = ( SELECT period_end  FROM date_range)         OR period_end = ( SELECT period_beg  FROM date_range))) SELECT  cd.location_name,  ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = ( SELECT period_end  FROM date_range)  AND ld.period_end = ( SELECT period_beg  FROM date_range) ORDER BY 2 DESC LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "which is the city with the lowest change in the median rent price in Texas over the last year?", "sql": "WITH date_range AS (   SELECT    MAX(period_end) - INTERVAL '0 months' AS period_end,    MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.renthub_median_rent   WHERE dh_place_name <> '-' AND property_type = 'All Residential'),data AS (   SELECT    location_name,    metric_value AS median_price,    period_end   FROM public.renthub_median_rent   WHERE geo_type = 'city'    AND property_type = 'All Residential'    AND dh_state_name = 'Texas'    AND (period_end = ( SELECT period_end  FROM date_range)         OR period_end = ( SELECT period_beg  FROM date_range))) SELECT  cd.location_name,  ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = ( SELECT period_end  FROM date_range)  AND ld.period_end = ( SELECT period_beg  FROM date_range) ORDER BY 2 LIMIT 1;" , "db":"v2_real_estate"}
{"nl_question": "which is the city with the lowest change in the median sale price in Texas over the last year?", "sql": "WITH date_range AS (   SELECT    MAX(period_end) - INTERVAL '0 months' AS period_end,    MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.redfin_median_sale_price   WHERE dh_place_name <> '-' AND property_type = 'All Residential'),data AS (   SELECT    location_name,    metric_value AS median_price,    period_end   FROM public.redfin_median_sale_price   WHERE geo_type = 'city'    AND property_type = 'All Residential'    AND dh_state_name = 'Texas'    AND (period_end = ( SELECT period_end  FROM date_range)         OR period_end = ( SELECT period_beg  FROM date_range))) SELECT  cd.location_name,  ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = ( SELECT period_end  FROM date_range)  AND ld.period_end = ( SELECT period_beg  FROM date_range) ORDER BY 2 LIMIT 1;" , "db":"v2_real_estate"}
{"nl_question": "which is the city with the lowest change in the inventory of Real Estate in North Carolina over the last year?", "sql": "WITH date_range AS (   SELECT    MAX(period_end) - INTERVAL '0 months' AS period_end,    MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.redfin_inventory   WHERE dh_place_name <> '-' AND property_type = 'All Residential'),data AS (   SELECT    location_name,    metric_value AS median_price,    period_end   FROM public.redfin_inventory   WHERE geo_type = 'city'    AND property_type = 'All Residential'    AND dh_state_name = 'North Carolina'    AND (period_end = ( SELECT period_end  FROM date_range)         OR period_end = ( SELECT period_beg  FROM date_range))) SELECT  cd.location_name,  ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = ( SELECT period_end  FROM date_range)  AND ld.period_end = ( SELECT period_beg  FROM date_range) ORDER BY 2 LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "which is the city with the lowest change in the number of new listings of Real Estate in Ohio over the last year?", "sql": "WITH date_range AS (   SELECT    MAX(period_end) - INTERVAL '0 months' AS period_end,    MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.redfin_new_listings   WHERE dh_place_name <> '-' AND property_type = 'All Residential'),data AS (   SELECT    location_name,    metric_value AS median_price,    period_end   FROM public.redfin_new_listings   WHERE geo_type = 'city'    AND property_type = 'All Residential'    AND dh_state_name = 'Ohio'    AND (period_end = ( SELECT period_end  FROM date_range)         OR period_end = ( SELECT period_beg  FROM date_range))) SELECT  cd.location_name,  ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = ( SELECT period_end  FROM date_range)  AND ld.period_end = ( SELECT period_beg  FROM date_range) ORDER BY 2 LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "How much did median rent price change over the past year in Miami city?", "sql": "WITH date_range AS (   SELECT    MAX(period_end) - INTERVAL '0 months' AS period_end,    MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.renthub_median_rent   WHERE dh_place_name <> '-' AND property_type = 'All Residential'),data AS (   SELECT    location_name,    metric_value AS median_price,    period_end   FROM public.renthub_median_rent   WHERE geo_type = 'city'    AND property_type = 'All Residential'    AND dh_state_name = 'Florida' AND dh_place_name = 'Miami'     AND (period_end = ( SELECT period_end  FROM date_range)         OR period_end = ( SELECT period_beg  FROM date_range))) SELECT  cd.location_name,  ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = ( SELECT period_end  FROM date_range)  AND ld.period_end = ( SELECT period_beg  FROM date_range) ORDER BY 2 DESC LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "How much did median sale price change over the past year in Dade county ?", "sql": "WITH date_range AS (   SELECT    MAX(period_end) - INTERVAL '0 months' AS period_end,    MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.redfin_median_sale_price   WHERE dh_place_name <> '-' AND property_type = 'All Residential'),data AS (   SELECT    location_name,    metric_value AS median_price,    period_end   FROM public.redfin_median_sale_price   WHERE geo_type='county'      AND dh_state_name = 'Florida'       and dh_county_name = 'Miami-Dade'    AND (period_end = ( SELECT period_end  FROM date_range)         OR period_end = ( SELECT period_beg  FROM date_range))) SELECT  cd.location_name,  ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = ( SELECT period_end  FROM date_range)  AND ld.period_end = ( SELECT period_beg  FROM date_range) ORDER BY 2 DESC LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "How much did real estate inventory change over the past year in Los Angeles county ?", "sql": "WITH date_range AS (   SELECT    MAX(period_end) - INTERVAL '0 months' AS period_end,    MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.redfin_inventory   WHERE dh_place_name <> '-' AND property_type = 'All Residential'),data AS (   SELECT    location_name,    metric_value AS median_price,    period_end   FROM public.redfin_inventory   WHERE geo_type='county'      AND dh_state_name = 'California'       and dh_county_name = 'Los Angeles'    AND (period_end = ( SELECT period_end  FROM date_range)         OR period_end = ( SELECT period_beg  FROM date_range))) SELECT  cd.location_name,  ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = ( SELECT period_end  FROM date_range)  AND ld.period_end = ( SELECT period_beg  FROM date_range) ORDER BY 2 DESC LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "How much did real estate new listings number change over the past year in Queens county ?", "sql": "WITH date_range AS (   SELECT    MAX(period_end) - INTERVAL '0 months' AS period_end,    MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.redfin_new_listings   WHERE dh_place_name <> '-' AND property_type = 'All Residential'),data AS (   SELECT    location_name,    metric_value AS median_price,    period_end   FROM public.redfin_new_listings   WHERE geo_type='county'   and dh_state_name = 'New York'   and dh_county_name = 'Queens'    AND (period_end = ( SELECT period_end  FROM date_range)         OR period_end = ( SELECT period_beg  FROM date_range))) SELECT  cd.location_name,  ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = ( SELECT period_end  FROM date_range)  AND ld.period_end = ( SELECT period_beg  FROM date_range) ORDER BY 2 DESC LIMIT 1" , "db":"v2_real_estate"}
{"nl_question": "Which property type had the highest median sale price in Miami city?", "sql": "     SELECT       period_end,      location_name,      property_type,      metric_value      FROM public.redfin_median_sale_price     WHERE geo_type = 'city'      AND dh_state_name = 'Florida'      AND dh_place_name = 'Miami'       ORDER BY period_end DESC, metric_value DESC   LIMIT 1 " , "db":"v2_real_estate"}
{"nl_question": "Which property type had the highest median rent price in Dade county ?", "sql": "   SELECT       period_end,      location_name,      property_type,      metric_value      FROM public.renthub_median_rent       WHERE geo_type='county'      AND dh_state_name = 'Florida'       and dh_county_name = 'Miami-Dade'       ORDER BY period_end DESC, metric_value DESC   LIMIT 1 " , "db":"v2_real_estate"}
{"nl_question": "Which property type had the highest inventory of real estate in Los Angeles county ?", "sql": "   SELECT       period_end,      location_name,      property_type,      metric_value      FROM public.redfin_inventory       WHERE geo_type='county'      AND dh_state_name = 'California'       and dh_county_name = 'Los Angeles'       ORDER BY period_end DESC, metric_value DESC   LIMIT 1 " , "db":"v2_real_estate"}
{"nl_question": "Which property type had the highest new listings number in Queens county ?", "sql": "   SELECT   period_end,  location_name,  property_type,  metric_value    FROM public.renthub_median_rent   WHERE true   and geo_type='county'   and dh_state_name = 'New York'   and dh_county_name = 'Queens'    ORDER BY period_end DESC, metric_value DESC   LIMIT 1     " , "db":"v2_real_estate"}
{"nl_question": "How does the median sale price compare across Dade county  and Los Angeles county?", "sql": "  WITH location_1 AS (     SELECT       period_end,      location_name,      metric_value      FROM public.redfin_median_sale_price     WHERE geo_type = 'county'      AND property_type = 'All Residential'      AND dh_state_name = 'Florida'      AND dh_county_name = 'Miami-Dade'       ORDER BY period_end DESC   LIMIT 1)  ,  location_2 AS (     SELECT       period_end,      location_name,      metric_value      FROM public.redfin_median_sale_price     WHERE geo_type = 'county'      AND property_type = 'All Residential'      AND dh_state_name = 'California'      AND dh_county_name = 'Los Angeles'       ORDER BY period_end DESC   LIMIT 1  )   SELECT       l1.location_name,      l1.metric_value,      l2.metric_value,      (l1.metric_value - l2.metric_value)/ l1.metric_value AS pct_change   FROM location_1 l1, location_2 l2 " , "db":"v2_real_estate"}
{"nl_question": "How does the median rent price compare across Los Angeles county  and Queens county?", "sql": "    WITH location_1 AS (     SELECT       period_end,      location_name,      metric_value      FROM public.renthub_median_rent     WHERE geo_type = 'county'      AND property_type = 'All Residential'      AND dh_state_name = 'California'      AND dh_county_name = 'Los Angeles'       ORDER BY period_end DESC   LIMIT 1)  ,  location_2 AS (     SELECT       period_end,      location_name,      metric_value      FROM public.renthub_median_rent     WHERE geo_type = 'county'      AND property_type = 'All Residential'      AND dh_state_name = 'New York'      AND dh_county_name = 'Queens'       ORDER BY period_end DESC   LIMIT 1  )   SELECT       l1.location_name,      l1.metric_value,      l2.metric_value,      (l1.metric_value - l2.metric_value)/ l1.metric_value AS pct_change   FROM location_1 l1, location_2 l2 " , "db":"v2_real_estate"}
{"nl_question": "How does the inventory of real estate compare across Miami city  and Orlando?", "sql": "    WITH location_1 AS (     SELECT       period_end,      location_name,      metric_value      FROM public.redfin_inventory     WHERE geo_type = 'city'      AND property_type = 'All Residential'      AND dh_state_name = 'Florida'      AND dh_place_name = 'Miami'       ORDER BY period_end DESC   LIMIT 1)  ,  location_2 AS (     SELECT       period_end,      location_name,      metric_value      FROM public.redfin_inventory     WHERE geo_type = 'city'      AND property_type = 'All Residential'      AND dh_state_name = 'Florida'      AND dh_place_name = 'Orlando'       ORDER BY period_end DESC   LIMIT 1  )   SELECT       l1.location_name,      l1.metric_value,      l2.metric_value,      (l1.metric_value - l2.metric_value)/ l1.metric_value AS pct_change   FROM location_1 l1, location_2 l2 " , "db":"v2_real_estate"}
{"nl_question": "How does the new listings in real estate compare across Chicago  and San Francisco?", "sql": "  WITH location_1 AS (     SELECT       period_end,      location_name,      metric_value      FROM public.redfin_new_listings     WHERE geo_type = 'city'      AND property_type = 'All Residential'      AND dh_state_name = 'Illinois'      AND dh_place_name = 'Chicago'       ORDER BY period_end DESC   LIMIT 1)  ,  location_2 AS (     SELECT       period_end,      location_name,      metric_value      FROM public.redfin_new_listings     WHERE geo_type = 'city'      AND property_type = 'All Residential'      AND dh_state_name = 'California'      AND dh_place_name = 'San Francisco'       ORDER BY period_end DESC   LIMIT 1  )   SELECT       l1.location_name,      l1.metric_value,      l2.metric_value,      (l1.metric_value - l2.metric_value)/ l1.metric_value AS pct_change   FROM location_1 l1, location_2 l2 " , "db":"v2_real_estate"}
{"nl_question": "What's the percent change in median sale price for Angeles county in the past month?", "sql": "  WITH date_range AS (     SELECT      MAX(period_end) - INTERVAL '0 months' AS period_end,      MAX(period_end) - INTERVAL '1 months' AS period_beg     FROM public.redfin_median_sale_price     WHERE dh_place_name <> '-' AND property_type = 'All Residential'  ),  data AS (     SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.redfin_median_sale_price     WHERE geo_type = 'city'      AND property_type = 'All Residential'      AND dh_state_name = 'California'      AND dh_place_name = 'Los Angeles'      AND (period_end = ( SELECT period_end  FROM date_range)           OR period_end = ( SELECT period_beg  FROM date_range))  )   SELECT    cd.location_name,    ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change   FROM data cd   JOIN data ld ON cd.location_name = ld.location_name   WHERE cd.period_end = ( SELECT period_end  FROM date_range)    AND ld.period_end = ( SELECT period_beg  FROM date_range)   ORDER BY 2 DESC   LIMIT 1 " , "db":"v2_real_estate"}
{"nl_question": "What's the percent change in median rent price for Queens county in the past month?", "sql": "  WITH date_range AS (     SELECT      MAX(period_end) - INTERVAL '0 months' AS period_end,      MAX(period_end) - INTERVAL '1 months' AS period_beg     FROM public.renthub_median_rent     WHERE dh_place_name <> '-' AND property_type = 'All Residential'  ),  data AS (     SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.renthub_median_rent     WHERE geo_type = 'county'      AND property_type = 'All Residential'      AND dh_state_name = 'New York'      AND dh_place_name = 'Queens'      AND (period_end = ( SELECT period_end  FROM date_range)           OR period_end = ( SELECT period_beg  FROM date_range))  )   SELECT    cd.location_name,    ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change   FROM data cd   JOIN data ld ON cd.location_name = ld.location_name   WHERE cd.period_end = ( SELECT period_end  FROM date_range)    AND ld.period_end = ( SELECT period_beg  FROM date_range)   ORDER BY 2 DESC   LIMIT 1 " , "db":"v2_real_estate"}
{"nl_question": "What's the percent change in inventory of real estatea for Orlando in the past month?", "sql": "  WITH date_range AS (     SELECT      MAX(period_end) - INTERVAL '0 months' AS period_end,      MAX(period_end) - INTERVAL '1 months' AS period_beg     FROM public.redfin_inventory     WHERE dh_place_name <> '-' AND property_type = 'All Residential'  ),  data AS (     SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.redfin_inventory     WHERE geo_type = 'city'      AND property_type = 'All Residential'      AND dh_state_name = 'Florida'      AND dh_place_name = 'Orlando'      AND (period_end = ( SELECT period_end  FROM date_range)           OR period_end = ( SELECT period_beg  FROM date_range))  )   SELECT    cd.location_name,    ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change   FROM data cd   JOIN data ld ON cd.location_name = ld.location_name   WHERE cd.period_end = ( SELECT period_end  FROM date_range)    AND ld.period_end = ( SELECT period_beg  FROM date_range)   ORDER BY 2 DESC   LIMIT 1 " , "db":"v2_real_estate"}
{"nl_question": "What's the percent change in new listings in real estate for San Francisco in the past month?", "sql": "  WITH date_range AS (     SELECT      MAX(period_end) - INTERVAL '0 months' AS period_end,      MAX(period_end) - INTERVAL '1 months' AS period_beg     FROM public.redfin_new_listings     WHERE dh_place_name <> '-' AND property_type = 'All Residential'  ),  data AS (     SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.redfin_new_listings     WHERE geo_type = 'city'      AND property_type = 'All Residential'      AND dh_state_name = 'California'      AND dh_place_name = 'San Francisco'      AND (period_end = ( SELECT period_end  FROM date_range)           OR period_end = ( SELECT period_beg  FROM date_range))  )   SELECT    cd.location_name,    ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change   FROM data cd   JOIN data ld ON cd.location_name = ld.location_name   WHERE cd.period_end = ( SELECT period_end  FROM date_range)    AND ld.period_end = ( SELECT period_beg  FROM date_range)   ORDER BY 2 DESC   LIMIT 1 " , "db":"v2_real_estate"}
{"nl_question": "What is the median rent price type in Dade county for Apartment Building?", "sql": "   SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.renthub_median_rent     WHERE geo_type = 'county'      AND property_type = 'Apartment Building'      AND dh_state_name = 'Florida'      AND dh_county_name  = 'Miami-Dade'   ORDER BY period_end DESC, metric_value DESC   LIMIT 1     " , "db":"v2_real_estate"}
{"nl_question": "What is the median sale price type in Orlando for Multi-family?", "sql": "   SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.redfin_median_sale_price     WHERE geo_type = 'city'      AND property_type = 'Multi-family'      AND dh_state_name = 'Florida'      AND dh_county_name  = 'Orlando'   ORDER BY period_end DESC, metric_value DESC   LIMIT 1   " , "db":"v2_real_estate"}
{"nl_question": "What is the total number of listings type in San Francisco for Single-family?", "sql": "     SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.redfin_inventory     WHERE geo_type = 'city'      AND property_type = 'Multi-family'      AND dh_state_name = 'Florida'      AND dh_county_name  = 'Orlando'   ORDER BY period_end DESC, metric_value DESC   LIMIT 1   " , "db":"v2_real_estate"}
{"nl_question": "How many new listings are there each property type in a San antonio texas for Townhouse?", "sql": "   SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.redfin_new_listings     WHERE geo_type = 'city'      AND property_type = 'Townhouse'      AND dh_state_name = 'Texas'      AND dh_county_name  = 'San Antonio'   ORDER BY period_end DESC, metric_value DESC   LIMIT 1       " , "db":"v2_real_estate"}
{"nl_question": "How much did median rent price change over the past year in Miami city Condo?", "sql": "  WITH date_range AS (     SELECT      MAX(period_end) - INTERVAL '0 months' AS period_end,      MAX(period_end) - INTERVAL '12 months' AS period_beg     FROM public.renthub_median_rent     WHERE dh_place_name <> '-' AND property_type = 'Condo'  ),  data AS (     SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.renthub_median_rent     WHERE geo_type = 'city'      AND property_type = 'Condo'      AND dh_state_name = 'Florida'      AND dh_place_name = 'Miami'      AND (period_end = ( SELECT period_end  FROM date_range)           OR period_end = ( SELECT period_beg  FROM date_range))  )   SELECT    cd.location_name,    ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change   FROM data cd   JOIN data ld ON cd.location_name = ld.location_name   WHERE cd.period_end = ( SELECT period_end  FROM date_range)    AND ld.period_end = ( SELECT period_beg  FROM date_range)   ORDER BY 2 DESC   LIMIT 1 " , "db":"v2_real_estate"}
{"nl_question": "How much did median sale price change over the past year in North Carolina for Single-family ?", "sql": "  WITH date_range AS (     SELECT      MAX(period_end) - INTERVAL '0 months' AS period_end,      MAX(period_end) - INTERVAL '12 months' AS period_beg     FROM public.redfin_median_sale_price     WHERE dh_place_name <> '-' AND property_type = 'Single-family'  ),  data AS (     SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.redfin_median_sale_price     WHERE geo_type = 'state'      AND property_type = 'Single-family'      AND dh_state_name = 'North Carolina'            AND (period_end = ( SELECT period_end  FROM date_range)           OR period_end = ( SELECT period_beg  FROM date_range))  )   SELECT    cd.location_name,    ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change   FROM data cd   JOIN data ld ON cd.location_name = ld.location_name   WHERE cd.period_end = ( SELECT period_end  FROM date_range)    AND ld.period_end = ( SELECT period_beg  FROM date_range)   ORDER BY 2 DESC   LIMIT 1 " , "db":"v2_real_estate"}
{"nl_question": "How much did real estate inventory change over the past year in Illinois for Multi-family?", "sql": "    WITH date_range AS (     SELECT      MAX(period_end) - INTERVAL '0 months' AS period_end,      MAX(period_end) - INTERVAL '12 months' AS period_beg     FROM public.redfin_inventory     WHERE dh_place_name <> '-' AND property_type = 'Multi-family'  ),  data AS (     SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.redfin_inventory     WHERE geo_type = 'state'      AND property_type = 'Multi-family'      AND dh_state_name = 'Illinois'            AND (period_end = ( SELECT period_end  FROM date_range)           OR period_end = ( SELECT period_beg  FROM date_range))  )   SELECT    cd.location_name,    ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change   FROM data cd   JOIN data ld ON cd.location_name = ld.location_name   WHERE cd.period_end = ( SELECT period_end  FROM date_range)    AND ld.period_end = ( SELECT period_beg  FROM date_range)   ORDER BY 2 DESC   LIMIT 1 " , "db":"v2_real_estate"}
{"nl_question": "How much did real estate new listings number change over the past year in Queens county for Townhouse?", "sql": "  WITH date_range AS (     SELECT      MAX(period_end) - INTERVAL '0 months' AS period_end,      MAX(period_end) - INTERVAL '12 months' AS period_beg     FROM public.redfin_new_listings     WHERE dh_place_name <> '-' AND property_type = 'Multi-family'  ),  data AS (     SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.redfin_new_listings     WHERE geo_type = 'county'      AND property_type = 'Multi-family'      AND dh_state_name = 'New York'       and dh_county_name  = 'Queens'      AND (period_end = ( SELECT period_end  FROM date_range)           OR period_end = ( SELECT period_beg  FROM date_range))  )   SELECT    cd.location_name,    ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change   FROM data cd   JOIN data ld ON cd.location_name = ld.location_name   WHERE cd.period_end = ( SELECT period_end  FROM date_range)    AND ld.period_end = ( SELECT period_beg  FROM date_range)   ORDER BY 2 DESC   LIMIT 1 " , "db":"v2_real_estate"}
{"nl_question": "Which property type had the highest median sale price in Florida for Condo?", "sql": "   SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.redfin_median_sale_price     WHERE geo_type = 'state'      AND property_type = 'Condo'      AND dh_state_name = 'Florida'   ORDER BY period_end DESC, metric_value DESC   LIMIT 1   " , "db":"v2_real_estate"}
{"nl_question": "Which property type had the highest median rent price in Dade county for Single unit?", "sql": "   SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.renthub_median_rent     WHERE geo_type = 'county'      AND property_type = 'Single unit'      AND dh_state_name = 'Florida'      AND dh_county_name  = 'Miami-Dade'   ORDER BY period_end DESC, metric_value DESC   LIMIT 1   " , "db":"v2_real_estate"}
{"nl_question": "Which property type had the highest inventory of real estate in Nevada county for Townhouse?", "sql": "   SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.redfin_inventory     WHERE geo_type = 'county'      AND property_type = 'Townhouse'      AND dh_state_name = 'Florida'      AND dh_county_name  = 'Nevada'   ORDER BY period_end DESC, metric_value DESC   LIMIT 1   " , "db":"v2_real_estate"}
{"nl_question": "Which property type had the highest new listings number in Queens county for Multi-family?", "sql": "   SELECT      location_name,      metric_value AS median_price,      period_end     FROM public.redfin_new_listings     WHERE geo_type = 'county'      AND property_type = 'Multi-family'      AND dh_state_name = 'Florida'      AND dh_county_name  = 'Queens'   ORDER BY period_end DESC, metric_value DESC   LIMIT 1     " , "db":"v2_real_estate"}
{"nl_question": "Did median sale price increase/decrease in Orlando for Apartment Building over the past year?", "sql": "  WITH date_range AS (     SELECT       max(period_end) - interval '1 month' AS period_end,      max(period_end) - interval '12 months' AS period_beg     FROM public.renthub_median_rent     WHERE dh_place_name <> '-'      AND property_type = 'Apartment Building'  ),   current_data AS (     SELECT       metric_value AS average_price     FROM public.renthub_median_rent     WHERE geo_type = 'city'      AND property_type = 'Apartment Building'      AND dh_state_name = 'Florida'      AND dh_place_name = 'Orlando'      AND period_end = ( SELECT period_end  FROM date_range)  ),  last_month_data AS (     SELECT       metric_value AS average_price     FROM public.renthub_median_rent     WHERE geo_type = 'city'      AND property_type = 'Apartment Building'      AND dh_state_name = 'Florida'      AND dh_place_name = 'Orlando'      AND period_end = ( SELECT period_beg  FROM date_range)  )   SELECT     CASE      WHEN ABS((cd.average_price - ld.average_price) / ld.average_price) BETWEEN 0.0 AND 0.01 THEN CONCAT(TO_CHAR(ABS(cd.average_price - ld.average_price) / ld.average_price * 100, '0.99'), '%')      ELSE CONCAT(TO_CHAR(ABS((cd.average_price - ld.average_price) / ld.average_price) * 100, '99.9'), '%')    END AS pct_change_abs,    CASE      WHEN (cd.average_price - ld.average_price) / ld.average_price > 0 THEN 'increased'      ELSE 'decreased'    END AS direction1   FROM current_data cd  CROSS  JOIN last_month_data ld " , "db":"v2_real_estate"}  
{"nl_question": "Did median rent price increase/decrease in Sacramento for Single unit over the past year?", "sql": "  WITH date_range AS (     SELECT       max(period_end) - interval '0 month' AS period_end,      max(period_end) - interval '12 months' AS period_beg     FROM public.redfin_median_sale_price     WHERE dh_place_name <> '-'      AND property_type like '%Single%'  ),   current_data AS (     SELECT       metric_value AS average_price     FROM public.redfin_median_sale_price     WHERE geo_type = 'city'      AND property_type like '%Single%'      AND dh_state_name = 'California'      AND dh_place_name = 'Sacramento'      AND period_end = ( SELECT period_end  FROM date_range)  ),  last_month_data AS (     SELECT       metric_value AS average_price     FROM public.redfin_median_sale_price     WHERE geo_type = 'city'      AND property_type like '%Single%'      AND dh_state_name = 'California'      AND dh_place_name = 'Sacramento'      AND period_end = ( SELECT period_beg  FROM date_range)  )   SELECT     CASE      WHEN ABS((cd.average_price - ld.average_price) / ld.average_price) BETWEEN 0.0 AND 0.01 THEN CONCAT(TO_CHAR(ABS(cd.average_price - ld.average_price) / ld.average_price * 100, '0.99'), '%')      ELSE CONCAT(TO_CHAR(ABS((cd.average_price - ld.average_price) / ld.average_price) * 100, '99.9'), '%')    END AS pct_change_abs,    CASE      WHEN (cd.average_price - ld.average_price) / ld.average_price > 0 THEN 'increased'      ELSE 'decreased'    END AS direction1   FROM current_data cd  CROSS  JOIN last_month_data ld " , "db":"v2_real_estate"}  
{"nl_question": "Did inventory of real estate increase/decrease in Las Vegas for Townhouse over the past year?", "sql": "  WITH date_range AS (     SELECT       max(period_end) - interval '0 month' AS period_end,      max(period_end) - interval '12 months' AS period_beg     FROM public.redfin_median_sale_price     WHERE dh_place_name <> '-'      AND property_type like '%Single%'  ),   current_data AS (     SELECT       metric_value AS average_price     FROM public.redfin_median_sale_price     WHERE geo_type = 'city'      AND property_type like '%Single%'      AND dh_state_name = 'California'      AND dh_place_name = 'Sacramento'      AND period_end = ( SELECT period_end  FROM date_range)  ),  last_month_data AS (     SELECT       metric_value AS average_price     FROM public.redfin_median_sale_price     WHERE geo_type = 'city'      AND property_type like '%Single%'      AND dh_state_name = 'California'      AND dh_place_name = 'Sacramento'      AND period_end = ( SELECT period_beg  FROM date_range)  )   SELECT     CASE      WHEN ABS((cd.average_price - ld.average_price) / ld.average_price) BETWEEN 0.0 AND 0.01 THEN CONCAT(TO_CHAR(ABS(cd.average_price - ld.average_price) / ld.average_price * 100, '0.99'), '%')      ELSE CONCAT(TO_CHAR(ABS((cd.average_price - ld.average_price) / ld.average_price) * 100, '99.9'), '%')    END AS pct_change_abs,    CASE      WHEN (cd.average_price - ld.average_price) / ld.average_price > 0 THEN 'increased'      ELSE 'decreased'    END AS direction1   FROM current_data cd  CROSS  JOIN last_month_data ld " , "db":"v2_real_estate"}  
{"nl_question": "Did new listings in real estate increase/decrease in San Antonio for Single-family over the past year?", "sql": "    WITH date_range AS (     SELECT       max(period_end) - interval '0 month' AS period_end,      max(period_end) - interval '12 months' AS period_beg     FROM public.redfin_inventory     WHERE dh_place_name <> '-'      AND property_type like '%Single%'  ),   current_data AS (     SELECT       metric_value AS average_price     FROM public.redfin_inventory     WHERE geo_type = 'city'      AND property_type like '%Single%'      AND dh_state_name = 'Texas'      AND dh_place_name = 'San Antonio'      AND period_end = ( SELECT period_end  FROM date_range)  ),  last_month_data AS (     SELECT       metric_value AS average_price     FROM public.redfin_inventory     WHERE geo_type = 'city'      AND property_type like '%Single%'      AND dh_state_name = 'Texas'      AND dh_place_name = 'San Antonio'      AND period_end = ( SELECT period_beg  FROM date_range)  )   SELECT     CASE      WHEN ABS((cd.average_price - ld.average_price) / ld.average_price) BETWEEN 0.0 AND 0.01 THEN CONCAT(TO_CHAR(ABS(cd.average_price - ld.average_price) / ld.average_price * 100, '0.99'), '%')      ELSE CONCAT(TO_CHAR(ABS((cd.average_price - ld.average_price) / ld.average_price) * 100, '99.9'), '%')    END AS pct_change_abs,    CASE      WHEN (cd.average_price - ld.average_price) / ld.average_price > 0 THEN 'increased'      ELSE 'decreased'    END AS direction1   FROM current_data cd  CROSS  JOIN last_month_data ld " , "db":"v2_real_estate"}  
{"nl_question": "Which city showed the highest total increase in median sale price for condo in Texas?", "sql": "  WITH date_range AS (     SELECT       max(period_end) - interval '0 month' AS period_end,      max(period_end) - interval '12 months' AS period_beg     FROM public.renthub_median_rent     WHERE dh_place_name <> '-'      AND property_type like '%Condo%'  ),   current_data AS (     SELECT     location_name,      metric_value      FROM public.renthub_median_rent     WHERE geo_type = 'city'      AND property_type like '%Condo%'      AND dh_state_name = 'Texas'            AND period_end = ( SELECT period_end  FROM date_range)  ),  last_month_data AS (     SELECT     location_name,      metric_value      FROM public.renthub_median_rent     WHERE geo_type = 'city'      AND property_type like '%Condo%'      AND dh_state_name = 'Texas'            AND period_end = ( SELECT period_beg  FROM date_range)  )   SELECT   cd.location_name, cd.metric_value, ld.metric_value,  ((cd.metric_value - ld.metric_value) / ld.metric_value) as pct_change     FROM current_data cd  inner  JOIN last_month_data ld  ON cd.location_name = ld.location_name   ORDER by 4 desc    LIMIT 1     " , "db":"v2_real_estate"}
{"nl_question": "Which county showed the highest total increase in median rent price for Multi-family in Florida?", "sql": "  WITH date_range AS (     SELECT       max(period_end) - interval '0 month' AS period_end,      max(period_end) - interval '12 months' AS period_beg     FROM public.redfin_median_sale_price     WHERE dh_place_name <> '-'      AND property_type like '%Multi%'  ),   current_data AS (     SELECT     location_name,      metric_value      FROM public.redfin_median_sale_price     WHERE geo_type = 'county'      AND property_type like '%Multi%'      AND dh_state_name = 'Florida'            AND period_end = ( SELECT period_end  FROM date_range)  ),  last_month_data AS (     SELECT     location_name,      metric_value      FROM public.redfin_median_sale_price     WHERE geo_type = 'county'      AND property_type like '%Multi%'      AND dh_state_name = 'Florida'            AND period_end = ( SELECT period_beg  FROM date_range)  )   SELECT   cd.location_name, cd.metric_value, ld.metric_value,  ((cd.metric_value - ld.metric_value) / ld.metric_value) as pct_change     FROM current_data cd  inner  JOIN last_month_data ld  ON cd.location_name = ld.location_name   ORDER by 4 desc    LIMIT 1   " , "db":"v2_real_estate"}
{"nl_question": "Which zip showed the highest total increase in real estate inventory for single-family in Nevada?", "sql": "  WITH date_range AS (     SELECT       max(period_end) - interval '0 month' AS period_end,      max(period_end) - interval '12 months' AS period_beg     FROM public.redfin_inventory     WHERE dh_place_name <> '-'      AND property_type like '%single%'  ),   current_data AS (     SELECT     location_name,      metric_value      FROM public.redfin_inventory     WHERE geo_type = 'zip'      AND property_type like '%single%'      AND dh_state_name = 'Nevada'            AND period_end = ( SELECT period_end  FROM date_range)  ),  last_month_data AS (     SELECT     location_name,      metric_value      FROM public.redfin_inventory     WHERE geo_type = 'zip'      AND property_type like '%single%'      AND dh_state_name = 'Nevada'            AND period_end = ( SELECT period_beg  FROM date_range)  )   SELECT   cd.location_name, cd.metric_value, ld.metric_value,  ((cd.metric_value - ld.metric_value) / ld.metric_value) as pct_change     FROM current_data cd  inner  JOIN last_month_data ld  ON cd.location_name = ld.location_name   ORDER by 4 desc    LIMIT 1   " , "db":"v2_real_estate"}
{"nl_question": "Which city showed the highest total increase in new listings for real estate for townhouse in Ohio?", "sql": "  WITH date_range AS (     SELECT       max(period_end) - interval '0 month' AS period_end,      max(period_end) - interval '12 months' AS period_beg     FROM public.redfin_new_listings     WHERE dh_place_name <> '-'      AND property_type like '%Single%'  ),   current_data AS (     SELECT     location_name,      metric_value      FROM public.redfin_new_listings     WHERE geo_type = 'zip'      AND property_type like '%Single%'      AND dh_state_name = 'Ohio'            AND period_end = ( SELECT period_end  FROM date_range)  ),  last_month_data AS (     SELECT     location_name,      metric_value      FROM public.redfin_new_listings     WHERE geo_type = 'zip'      AND property_type like '%Single%'      AND dh_state_name = 'Ohio'            AND period_end = ( SELECT period_beg  FROM date_range)  )   SELECT   cd.location_name, cd.metric_value, ld.metric_value,  ((cd.metric_value - ld.metric_value) / ld.metric_value) as pct_change     FROM current_data cd  inner  JOIN last_month_data ld  ON cd.location_name = ld.location_name   ORDER by 4 desc    LIMIT 1 " , "db":"v2_real_estate"}
{"nl_question":"In which city in California are the median sale prices higher for single family compared to Townhouses?", "sql": "  with prop_type_1 as (  SELECT  dh_place_name, property_type, max(metric_value) as metric_value   FROM public.redfin_median_sale_price  WHERE true  and geo_type='city'  and property_type='Single-family'  and dh_state_name='California'  and period_end= ( SELECT max(period_end)  FROM redfin_median_sale_price) group by 1,2 ) , prop_type_2 as (  SELECT  dh_place_name, property_type, max(metric_value) as metric_value   FROM public.redfin_median_sale_price  WHERE true  and geo_type='city'  and property_type ='Townhouse'  and dh_state_name='California'  and period_end= ( SELECT max(period_end)  FROM redfin_median_sale_price) group by 1,2 )   SELECT  pt_1.dh_place_name, pt_1.property_type, pt_1.metric_value as pt1_value, pt_2.dh_place_name, pt_2.property_type, pt_2.metric_value as pt2_value   FROM prop_type_1 as pt_1 inner  JOIN prop_type_2 as pt_2 ON pt_1.dh_place_name = pt_2.dh_place_name  and pt_1.metric_value> pt_2.metric_value    ", "db":"v2_real_estate"}
{"nl_question":"In which city in Texas are the median rent prices higher for Townhouses compared to Condos?", "sql": "  with prop_type_1 as (  SELECT  dh_place_name, property_type, max(metric_value) as metric_value   FROM public.renthub_median_rent  WHERE true  and geo_type='city'  and property_type='Townhouse'  and dh_state_name='Texas'  and period_end= ( SELECT max(period_end)  FROM renthub_median_rent) group by 1,2 ) , prop_type_2 as (  SELECT  dh_place_name, property_type, max(metric_value) as metric_value   FROM public.renthub_median_rent  WHERE true  and geo_type='city'  and property_type ='Condo/Co-op'   and dh_state_name='Texas'  and period_end= ( SELECT max(period_end)  FROM renthub_median_rent) group by 1,2 )   SELECT  pt_1.dh_place_name, pt_1.property_type, pt_1.metric_value as pt1_value, pt_2.dh_place_name, pt_2.property_type, pt_2.metric_value as pt2_value   FROM prop_type_1 as pt_1 inner  JOIN prop_type_2 as pt_2 ON pt_1.dh_place_name = pt_2.dh_place_name  and pt_1.metric_value> pt_2.metric_value    ", "db":"v2_real_estate"}
{"nl_question":"In which city in Nevada are the median rent prices higher for condos compared to Single families?", "sql": "   with prop_type_1 as (  SELECT  dh_place_name, property_type, max(metric_value) as metric_value   FROM public.redfin_inventory  WHERE true  and geo_type='city'  and property_type='Condo/Co-op'  and dh_state_name='Nevada'  and period_end= ( SELECT max(period_end)  FROM redfin_inventory) group by 1,2 ) , prop_type_2 as (  SELECT  dh_place_name, property_type, max(metric_value) as metric_value   FROM public.redfin_inventory  WHERE true  and geo_type='city'  and property_type ='Single-family'  and dh_state_name='Nevada'  and period_end= ( SELECT max(period_end)  FROM redfin_inventory) group by 1,2 )   SELECT  pt_1.dh_place_name, pt_1.property_type, pt_1.metric_value as pt1_value, pt_2.dh_place_name, pt_2.property_type, pt_2.metric_value as pt2_value   FROM prop_type_1 as pt_1 inner  JOIN prop_type_2 as pt_2 ON pt_1.dh_place_name = pt_2.dh_place_name  and pt_1.metric_value> pt_2.metric_value    ", "db":"v2_real_estate"}
{"nl_question":"In which city in Texas are the median rent prices higher for condos compared to Single families?", "sql": "  with prop_type_1 as (  SELECT  dh_place_name, property_type, max(metric_value) as metric_value   FROM public.redfin_new_listings  WHERE true  and geo_type='city'  and property_type='Condo/Co-op'  and dh_state_name='Texas'  and period_end= ( SELECT max(period_end)  FROM redfin_new_listings) group by 1,2 ) , prop_type_2 as (  SELECT  dh_place_name, property_type, max(metric_value) as metric_value   FROM public.redfin_new_listings  WHERE true  and geo_type='city'  and property_type ='Single-family'   and dh_state_name='Texas'  and period_end= ( SELECT max(period_end)  FROM redfin_new_listings) group by 1,2 )   SELECT  pt_1.dh_place_name, pt_1.property_type, pt_1.metric_value as pt1_value, pt_2.dh_place_name, pt_2.property_type, pt_2.metric_value as pt2_value   FROM prop_type_1 as pt_1 inner  JOIN prop_type_2 as pt_2 ON pt_1.dh_place_name = pt_2.dh_place_name  and pt_1.metric_value> pt_2.metric_value", "db":"v2_real_estate"}
{"nl_question": "Can you provide data on historical property rent prices in San Antonio, Texas over the past year?", "sql": " WITH date_range AS (   SELECT     MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.renthub_median_rent   WHERE dh_place_name <> '-' AND property_type = 'All Residential' ) SELECT  period_end, location_name, metric_value  FROM public.renthub_median_rent WHERE geo_type = 'city' AND property_type = 'All Residential' AND dh_state_name = 'Texas' AND dh_place_name  = 'San Antonio' AND period_end >= (SELECT period_beg FROM date_range) ORDER BY period_end DESC  ", "db":"v2_real_estate"}
{"nl_question": "Which is the difference for ZIP codes between the higher and lower rent value in Orlando ?", "sql": " WITH location_1 AS (   SELECT      period_end,     dh_place_name,     location_name,     metric_value    FROM public.renthub_median_rent   WHERE geo_type = 'zip'     AND property_type = 'All Residential'     AND dh_state_name = 'Florida'     AND dh_place_name = 'Orlando'     ORDER BY period_end DESC, metric_value LIMIT 1)   SELECT      ri.period_end,     ri.location_name,     (ri.metric_value- l1.metric_value) /l1.metric_value as pct_diff   FROM public.renthub_median_rent ri   INNER JOIN location_1 l1   ON ri.dh_place_name = l1.dh_place_name   AND ri.period_end = l1.period_end   WHERE ri.geo_type = 'city'     AND ri.property_type = 'All Residential'     AND ri.dh_state_name = 'Florida'     AND ri.dh_place_name = 'Orlando'     ORDER BY ri.period_end DESC LIMIT 1  ", "db":"v2_real_estate"}
{"nl_question": "how did rent prices changed bewteen 2020 and 2022 in Miami?", "sql": " WITH date_range AS (   SELECT     MAX(period_end) - INTERVAL '0 months' AS period_end,     MAX(period_end) - INTERVAL '24 months' AS period_beg   FROM public.renthub_median_rent   WHERE dh_place_name <> '-' AND property_type = 'All Residential' ), data AS (   SELECT     location_name,     metric_value AS median_price,     period_end   FROM public.renthub_median_rent   WHERE geo_type = 'city'     AND property_type = 'All Residential'     AND dh_state_name = 'Florida'     AND dh_place_name = 'Miami'     AND (period_end = (SELECT period_end FROM date_range)          OR period_end = (SELECT period_beg FROM date_range)) ) SELECT   cd.location_name,   ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = (SELECT period_end FROM date_range)   AND ld.period_end = (SELECT period_beg FROM date_range) ORDER BY 2 DESC LIMIT 1  REDFIN_MEDIAN_SALE_PRICE: ", "db":"v2_real_estate"}
{"nl_question": "which are the top 3 ZIP Codes with the highest property appreciation in Los Angeles?", "sql": " WITH date_range AS (   SELECT     MAX(period_end) - INTERVAL '0 months' AS period_end   FROM public.redfin_median_sale_price   WHERE dh_place_name <> '-' AND property_type = 'All Residential' ) SELECT     location_name,     metric_value AS median_price,     period_end   FROM public.redfin_median_sale_price   WHERE geo_type = 'zip'     AND property_type = 'All Residential'     AND dh_state_name = 'California'     AND dh_place_name  = 'Los Angeles'     AND period_end = (SELECT period_end FROM date_range) ORDER BY period_end DESC, metric_value DESC limit 3  ", "db":"v2_real_estate"}
{"nl_question": "which is the difference between the high median sale value ZIP Code in Los Angeles and the LA median?", "sql": "  WITH location_1 AS (   SELECT      period_end,     dh_place_name,     location_name,     metric_value    FROM public.redfin_median_sale_price   WHERE geo_type = 'zip'     AND property_type = 'All Residential'     AND dh_state_name = 'California'     AND dh_place_name = 'Los Angeles'     ORDER BY period_end DESC, metric_value DESC LIMIT 1)   SELECT      ri.period_end,     ri.location_name,     (ri.metric_value- l1.metric_value) /l1.metric_value as pct_diff   FROM public.redfin_median_sale_price ri   INNER JOIN location_1 l1   ON ri.dh_place_name = l1.dh_place_name   AND ri.period_end = l1.period_end   WHERE ri.geo_type = 'city'     AND ri.property_type = 'All Residential'     AND ri.dh_state_name = 'California'     AND ri.dh_place_name = 'Los Angeles'     ORDER BY ri.period_end DESC LIMIT 1  ", "db":"v2_real_estate"}
{"nl_question": "which is the difference between the most expensive ZIP Code in NY and Miami?", "sql": " WITH location_1 AS (   SELECT      period_end,     location_name,     metric_value    FROM public.redfin_median_sale_price   WHERE geo_type = 'zip'     AND property_type = 'All Residential'     AND dh_state_name = 'New York'     AND dh_place_name = 'New York'     ORDER BY period_end DESC, metric_value DESC LIMIT 1) , location_2 AS (   SELECT      period_end,     location_name,     metric_value    FROM public.redfin_median_sale_price   WHERE geo_type = 'zip'     AND property_type = 'All Residential'     AND dh_state_name = 'Florida'     AND dh_place_name = 'Miami'     ORDER BY period_end DESC, metric_value DESC LIMIT 1 ) SELECT      l1.location_name,     l1.metric_value,     l2.location_name,     l2.metric_value,     (l1.metric_value - l2.metric_value)/ l1.metric_value AS pct_change FROM location_1 l1, location_2 l2  ", "db":"v2_real_estate"}
{"nl_question": "which are the 3 cheapest sale prices by state?", "sql": " WITH date_range AS (   SELECT     MAX(period_end) - INTERVAL '0 months' AS period_end   FROM public.redfin_median_sale_price   WHERE dh_place_name <> '-' AND property_type = 'All Residential' )   SELECT     location_name,     metric_value,     period_end   FROM public.redfin_median_sale_price   WHERE geo_type = 'state'     AND property_type = 'All Residential'     AND period_end = (SELECT period_end FROM date_range)     order by metric_value     LIMIT 3  ", "db":"v2_real_estate"}
{"nl_question": "What are the most popular types of properties (e.g., single-family homes, condos, apartments) in California?", "sql": " WITH date_range AS (   SELECT     MAX(period_end) - INTERVAL '0 months' AS period_end   FROM public.REDFIN_INVENTORY   WHERE dh_place_name <> '-' AND property_type = 'All Residential' )  SELECT      period_end,     location_name,     property_type,     metric_value    FROM public.REDFIN_INVENTORY   WHERE geo_type = 'state'     AND dh_state_name = 'California'     AND period_end = (SELECT period_end FROM date_range)     ORDER BY period_end DESC, metric_value DESC  ", "db":"v2_real_estate"}
{"nl_question": "What are the current listings for single-family homes in LA?", "sql": " WITH date_range AS (   SELECT     MAX(period_end) - INTERVAL '0 months' AS period_end   FROM public.REDFIN_INVENTORY   WHERE dh_place_name <> '-' AND property_type = 'All Residential' )  SELECT      period_end,     location_name,     property_type,     metric_value    FROM public.REDFIN_INVENTORY   WHERE geo_type = 'zip'     AND dh_state_name = 'California'     AND dh_place_name = 'Los Angeles'     AND property_type = 'Single-family'     AND period_end = (SELECT period_end FROM date_range)     ORDER BY period_end DESC, metric_value DESC  ", "db":"v2_real_estate"}
{"nl_question": "which is the proportion of the total number of listings in LA over California?", "sql": " WITH date_range AS (   SELECT     MAX(period_end) - INTERVAL '0 months' AS period_end   FROM public.REDFIN_INVENTORY   WHERE dh_place_name <> '-' AND property_type = 'All Residential' )  SELECT      msp.period_end,     msp.location_name,     msp.property_type,     msp.metric_value,     msps.metric_value   FROM public.REDFIN_INVENTORY msp   INNER JOIN public.REDFIN_INVENTORY msps   ON msp.dh_state_name = msps.dh_state_name   AND msp.property_type = msps.property_type   and msp.period_end = msps.period_end   AND msps.geo_type = 'state'   WHERE msp.geo_type = 'city'     AND msp.dh_state_name = 'California'     AND msp.dh_place_name = 'Los Angeles'     AND msp.property_type = 'All Residential'     AND msp.period_end = (SELECT period_end FROM date_range)   ", "db":"v2_real_estate"}
{"nl_question": "Which are the top 10 zips with the higher new listings numbers in New York city?", "sql": " WITH date_range AS (   SELECT     MAX(period_end) - INTERVAL '0 months' AS period_end   FROM public.REDFIN_NEW_LISTINGS   WHERE dh_place_name <> '-' AND property_type = 'All Residential' )  SELECT      period_end,     location_name,     metric_value    FROM public.REDFIN_NEW_LISTINGS   WHERE geo_type = 'zip'     AND dh_place_name = 'New York'     AND property_type = 'All Residential'     AND period_end = (SELECT period_end FROM date_range)     ORDER BY period_end DESC, metric_value desc      limit 10  ", "db":"v2_real_estate"}
{"nl_question": "how did the new listings increased/decreased in New Orleans in the last year?", "sql": " WITH date_range AS (   SELECT     MAX(period_end) - INTERVAL '0 months' AS period_end,     MAX(period_end) - INTERVAL '12 months' AS period_beg   FROM public.REDFIN_NEW_LISTINGS   WHERE dh_place_name <> '-' AND property_type = 'All Residential' ), data AS (   SELECT     location_name,     metric_value AS median_price,     period_end   FROM public.REDFIN_NEW_LISTINGS   WHERE geo_type = 'city'     AND property_type = 'All Residential'     AND dh_state_name = 'Louisiana'     AND dh_place_name = 'New Orleans'     AND (period_end = (SELECT period_end FROM date_range)          OR period_end = (SELECT period_beg FROM date_range)) ) SELECT   cd.location_name,   ((cd.median_price - ld.median_price) / ld.median_price) AS pct_change FROM data cd JOIN data ld ON cd.location_name = ld.location_name WHERE cd.period_end = (SELECT period_end FROM date_range)   AND ld.period_end = (SELECT period_beg FROM date_range) ORDER BY 2 DESC LIMIT 1", "db":"v2_real_estate"}