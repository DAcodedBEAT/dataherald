[
    { "question": "rents in weho vs santa monica 2022 till today", "golden_sqls": [ "SELECT period_start, location_name, metric_value AS median_price FROM renthub_median_rent WHERE geo_type = 'city' AND property_type = 'All Residential' AND dh_state_name = 'California' AND (location_name = 'West Hollywood' OR location_name = 'Santa Monica') AND period_start >= '2022-01-01' ORDER BY period_start DESC, location_name;", "SELECT period_end, location_name, metric_value AS median_price FROM renthub_median_rent WHERE geo_type = 'city' AND property_type = 'All Residential' AND dh_state_name = 'California' AND (location_name = 'West Hollywood' OR location_name = 'Santa Monica') AND period_end >= '2022-01-01' ORDER BY period_end DESC, location_name;", "WITH weho_data AS (  SELECT period_start, metric_value AS weho_median_price  FROM renthub_median_rent  WHERE geo_type = 'city'  AND property_type = 'All Residential'  AND dh_state_name = 'California'  AND location_name = 'West Hollywood'  AND period_start >= '2022-01-01'  ORDER BY period_start DESC, location_name ), santa_monica_data AS (  SELECT period_start, metric_value AS sm_median_price  FROM renthub_median_rent  WHERE geo_type = 'city'  AND property_type = 'All Residential'  AND dh_state_name = 'California'  AND location_name = 'Santa Monica'  AND period_start >= '2022-01-01'  ORDER BY period_start DESC, location_name ) SELECT wd.period_start, weho_median_price, sm_median_price FROM weho_data wd JOIN santa_monica_data smd ON wd.period_start = smd.period_start ORDER BY period_start DESC;", "WITH weho_data AS (  SELECT period_end, metric_value AS weho_median_price  FROM renthub_median_rent  WHERE geo_type = 'city'  AND property_type = 'All Residential'  AND dh_state_name = 'California'  AND location_name = 'West Hollywood'  AND period_end >= '2022-01-01'  ORDER BY period_end DESC, location_name ), santa_monica_data AS (  SELECT period_end, metric_value AS sm_median_price  FROM renthub_median_rent  WHERE geo_type = 'city'  AND property_type = 'All Residential'  AND dh_state_name = 'California'  AND location_name = 'Santa Monica'  AND period_end >= '2022-01-01'  ORDER BY period_end DESC, location_name ) SELECT wd.period_end, weho_median_price, sm_median_price FROM weho_data wd JOIN santa_monica_data smd ON wd.period_end = smd.period_end ORDER BY period_end DESC;" ] },
    { "question": "which orange county zip codes had the highest rents in may 2023?", "golden_sqls": [ "SELECT location_name, metric_value AS median_rent FROM renthub_median_rent WHERE geo_type = 'zip'   AND property_type = 'All Residential'   AND dh_state_name = 'California'   AND dh_county_name = 'Orange'   AND period_start = '2023-05-01' ORDER BY metric_value DESC LIMIT 10;", "SELECT location_name, metric_value AS median_rent FROM renthub_median_rent WHERE geo_type = 'zip'   AND property_type = 'All Residential'   AND dh_state_name = 'California'   AND dh_county_name = 'Orange'   AND period_start = '2023-05-01' ORDER BY metric_value DESC;" ] },
    { "question": "are rents increasing in new york city?", "golden_sqls": [ "SELECT period_start, metric_value AS median_rent FROM renthub_median_rent WHERE geo_type = 'city'   AND property_type = 'All Residential'   AND dh_state_name = 'New York'   AND dh_place_name = 'New York' ORDER BY period_start DESC LIMIT 13;", "SELECT period_end, metric_value AS median_rent FROM renthub_median_rent WHERE geo_type = 'city'   AND property_type = 'All Residential'   AND dh_state_name = 'New York'   AND dh_place_name = 'New York' ORDER BY period_end DESC LIMIT 13;", "SELECT period_start, metric_value AS median_rent FROM renthub_median_rent WHERE geo_type = 'city'   AND property_type = 'All Residential'   AND dh_state_name = 'New York'   AND dh_place_name = 'New York' ORDER BY period_start DESC LIMIT 2;", "SELECT period_end, metric_value AS median_rent FROM renthub_median_rent WHERE geo_type = 'city'   AND property_type = 'All Residential'   AND dh_state_name = 'New York'   AND dh_place_name = 'New York' ORDER BY period_end DESC LIMIT 2;" ] },
    { "question": "which city has the most expensive apartments to rent?", "golden_sqls": [ "SELECT dh_city_name, dh_state_name, metric_value AS median_rent FROM renthub_median_rent WHERE geo_type = 'city'   AND property_type = 'Apartment Building' ORDER BY period_start DESC, metric_value DESC LIMIT 1;" ] },
    { "question": "is it more expensive to rent a single family house in CA or an apartment in NY?", "golden_sqls": [ "SELECT period_start, dh_state_name, property_type, metric_value AS median_price FROM renthub_median_rent WHERE geo_type = 'state'   AND ( (property_type = 'Single-family house' AND dh_state_name = 'California')      OR (property_type = 'Apartment Building' AND dh_state_name = 'New York') ) ORDER BY period_start DESC LIMIT 2;", "SELECT period_end, dh_state_name, property_type, metric_value AS median_price FROM renthub_median_rent WHERE geo_type = 'state'   AND ( (property_type = 'Single-family house' AND dh_state_name = 'California')      OR (property_type = 'Apartment Building' AND dh_state_name = 'New York') ) ORDER BY period_end DESC LIMIT 2;", "WITH ca_data AS (  SELECT period_start, metric_value AS CA_single_family_median_price  FROM renthub_median_rent  WHERE geo_type = 'state'    AND property_type = 'Single-family house'    AND dh_state_name = 'California'  ORDER BY period_start DESC LIMIT 1 ), ny_data AS (  SELECT period_start, metric_value AS NY_apartment_median_price  FROM renthub_median_rent  WHERE geo_type = 'state'    AND property_type = 'Apartment Building'    AND dh_state_name = 'New York'  ORDER BY period_start DESC LIMIT 1 ) SELECT cd.period_start, CA_single_family_median_price, NY_apartment_median_price FROM ca_data cd JOIN ny_data nd ON cd.period_start = nd.period_start;", "WITH ca_data AS (  SELECT period_end, metric_value AS CA_single_family_median_price  FROM renthub_median_rent  WHERE geo_type = 'state'    AND property_type = 'Single-family house'    AND dh_state_name = 'California'  ORDER BY period_end DESC LIMIT 1 ), ny_data AS (  SELECT period_end, metric_value AS NY_apartment_median_price  FROM renthub_median_rent  WHERE geo_type = 'state'    AND property_type = 'Apartment Building'    AND dh_state_name = 'New York'  ORDER BY period_end DESC LIMIT 1 ) SELECT cd.period_end, CA_single_family_median_price, NY_apartment_median_price FROM ca_data cd JOIN ny_data nd ON cd.period_end = nd.period_end;" ] },
    { "question": "los angeles home sale price trends by building type in 2023", "golden_sqls": [ "SELECT period_start, property_type, metric_value AS median_price FROM redfin_median_sale_price WHERE geo_type = 'city'   AND dh_state_name = 'California'   AND dh_place_name = 'Los Angeles'   AND property_type <> 'All Residential'   AND period_start >= '2023-01-01' ORDER BY period_start DESC, property_type;", "SELECT period_end, property_type, metric_value AS median_price FROM redfin_median_sale_price WHERE geo_type = 'city'   AND dh_state_name = 'California'   AND dh_place_name = 'Los Angeles'   AND property_type <> 'All Residential'   AND period_end >= '2023-01-01' ORDER BY period_end DESC, property_type;" ] },
    { "question": "List of top 5 most expensive cities to buy a townhouse this summer?", "golden_sqls": [ "SELECT dh_city_name, dh_state_name,        metric_value AS median_price FROM redfin_median_sale_price WHERE geo_type = 'city'   AND property_type = 'Townhouse' ORDER BY period_start DESC, metric_value DESC LIMIT 5;" ] },
    { "question": "which zip codes had the biggest percent change in home sale prices between jan 2022 and jan 2023?", "golden_sqls": [ "WITH DATA AS (  SELECT period_start, dh_zip_code, metric_value AS median_price  FROM redfin_median_sale_price  WHERE geo_type = 'zip'    AND property_type = 'All Residential'    AND (period_start = '2023-01-01'      OR period_start = '2022-01-01')) SELECT cd.dh_zip_code,        cd.median_price AS new_median_price,        ld.median_price AS old_median_price,        ((cd.median_price - ld.median_price) * 100 / ld.median_price) AS pct_change FROM DATA cd JOIN DATA ld ON cd.dh_zip_code = ld.dh_zip_code WHERE cd.period_start = '2023-01-01'   AND ld.period_start = '2022-01-01' ORDER BY pct_change DESC LIMIT 10;", "WITH DATA AS (  SELECT period_start, dh_zip_code, metric_value AS median_price  FROM redfin_median_sale_price  WHERE geo_type = 'zip'    AND property_type = 'All Residential'    AND (period_start = '2023-01-01'      OR period_start = '2022-01-01')) SELECT cd.dh_zip_code,        ((cd.median_price - ld.median_price) * 100 / ld.median_price) AS pct_change FROM DATA cd JOIN DATA ld ON cd.dh_zip_code = ld.dh_zip_code WHERE cd.period_start = '2023-01-01'   AND ld.period_start = '2022-01-01' ORDER BY pct_change DESC LIMIT 10;", "WITH DATA AS (  SELECT period_start, dh_zip_code, metric_value AS median_price  FROM redfin_median_sale_price  WHERE geo_type = 'zip'    AND property_type = 'All Residential'    AND (period_start = '2023-01-01'      OR period_start = '2022-01-01')) SELECT cd.dh_zip_code,        cd.median_price AS new_median_price,        ld.median_price AS old_median_price,        ((cd.median_price - ld.median_price) * 100 / ld.median_price) AS pct_change FROM DATA cd JOIN DATA ld ON cd.dh_zip_code = ld.dh_zip_code WHERE cd.period_start = '2023-01-01'   AND ld.period_start = '2022-01-01' ORDER BY pct_change DESC LIMIT 5;", "WITH DATA AS (  SELECT period_start, dh_zip_code, metric_value AS median_price  FROM redfin_median_sale_price  WHERE geo_type = 'zip'    AND property_type = 'All Residential'    AND (period_start = '2023-01-01'      OR period_start = '2022-01-01')) SELECT cd.dh_zip_code,        ((cd.median_price - ld.median_price) * 100 / ld.median_price) AS pct_change FROM DATA cd JOIN DATA ld ON cd.dh_zip_code = ld.dh_zip_code WHERE cd.period_start = '2023-01-01'   AND ld.period_start = '2022-01-01' ORDER BY pct_change DESC LIMIT 5;" ] },
    { "question": "Are condo sale prices going up in austin?", "golden_sqls": [ "SELECT period_start,        metric_value AS median_price FROM redfin_median_sale_price WHERE geo_type = 'city'   AND property_type = 'Condo/Co-op'   AND dh_state_name = 'Texas'   AND dh_place_name = 'Austin' ORDER BY period_start DESC LIMIT 2;", "SELECT period_end,        metric_value AS median_price FROM redfin_median_sale_price WHERE geo_type = 'city'   AND property_type = 'Condo/Co-op'   AND dh_state_name = 'Texas'   AND dh_place_name = 'Austin' ORDER BY period_end DESC LIMIT 2;" ] },
    { "question": "Austin vs SF vs LA home prices 2019 till today", "golden_sqls": [ "SELECT dh_state_name, dh_city_name, period_start, metric_value AS median_price FROM redfin_median_sale_price WHERE geo_type = 'city'   AND property_type = 'All Residential'   AND dh_state_name IN ('California', 'Texas')   AND location_name IN ('Austin', 'San Francisco', 'Los Angeles')   AND period_start BETWEEN '2019-01-01' AND '2023-11-16' ORDER BY period_start, dh_state_name, dh_city_name;" ] },
    { "question": "which month had the lowest number of homes sold in 2022?", "golden_sqls": [ "SELECT period_start, metric_value AS homes_sold FROM redfin_homes_sold WHERE geo_type = 'national'   AND property_type = 'All Residential'   AND is_seasonally_adjusted = False   AND period_start BETWEEN '2022-01-01' AND '2022-12-31' ORDER BY homes_sold ASC LIMIT 1;", "SELECT period_end, metric_value AS homes_sold FROM redfin_homes_sold WHERE geo_type = 'national'   AND property_type = 'All Residential'   AND is_seasonally_adjusted = False   AND period_end BETWEEN '2022-01-01' AND '2022-12-31' ORDER BY homes_sold ASC LIMIT 1;", "SELECT period_start FROM redfin_homes_sold WHERE geo_type = 'national'   AND property_type = 'All Residential'   AND is_seasonally_adjusted = False   AND period_start BETWEEN '2022-01-01' AND '2022-12-31' ORDER BY metric_value ASC LIMIT 1;", "SELECT period_end FROM redfin_homes_sold WHERE geo_type = 'national'   AND property_type = 'All Residential'   AND is_seasonally_adjusted = False   AND period_end BETWEEN '2022-01-01' AND '2022-12-31' ORDER BY metric_value ASC LIMIT 1;" ] },
    { "question": "home sale volume trends in CA by building type", "golden_sqls": [ "SELECT period_start,        property_type,        metric_value AS homes_sold FROM redfin_homes_sold WHERE geo_type = 'state'   AND dh_state_name = 'California'   AND property_type <> 'All Residential' ORDER BY period_start,          property_type;", "SELECT period_end,        property_type,        metric_value AS homes_sold FROM redfin_homes_sold WHERE geo_type = 'state'   AND dh_state_name = 'California'   AND property_type <> 'All Residential' ORDER BY period_end,          property_type;" ] },
    { "question": "Are there more single family sold in seattle or condos", "golden_sqls": [ "WITH DATA AS   (SELECT period_start,           property_type,           metric_value AS homes_sold    FROM redfin_homes_sold    WHERE geo_type = 'city'      AND dh_state_name = 'Washington'      AND dh_place_name = 'Seattle'      AND (property_type = 'Single-family'           OR property_type = 'Condo/Co-op')    ORDER BY period_start DESC LIMIT 2) SELECT period_start,        SUM(CASE                WHEN property_type = 'Single-family' THEN homes_sold                ELSE 0            END) AS single_family_homes_sold,        SUM(CASE                WHEN property_type = 'Condo/Co-op' THEN homes_sold                ELSE 0            END) AS condos_sold FROM DATA GROUP BY period_start;", "WITH DATA AS   (SELECT period_end,           property_type,           metric_value AS homes_sold    FROM redfin_homes_sold    WHERE geo_type = 'city'      AND dh_state_name = 'Washington'      AND dh_place_name = 'Seattle'      AND (property_type = 'Single-family'           OR property_type = 'Condo/Co-op')    ORDER BY period_end DESC LIMIT 2) SELECT period_end,        SUM(CASE                WHEN property_type = 'Single-family' THEN homes_sold                ELSE 0            END) AS single_family_homes_sold,        SUM(CASE                WHEN property_type = 'Condo/Co-op' THEN homes_sold                ELSE 0            END) AS condos_sold FROM DATA GROUP BY period_end;", "WITH DATA AS   (SELECT property_type,           metric_value AS homes_sold    FROM redfin_homes_sold    WHERE geo_type = 'city'      AND dh_state_name = 'Washington'      AND dh_place_name = 'Seattle'      AND (property_type = 'Single-family'           OR property_type = 'Condo/Co-op')    ORDER BY period_end DESC LIMIT 2) SELECT SUM(CASE                WHEN property_type = 'Single-family' THEN homes_sold                ELSE 0            END) AS single_family_homes_sold,        SUM(CASE                WHEN property_type = 'Condo/Co-op' THEN homes_sold                ELSE 0            END) AS condos_sold FROM DATA;", "SELECT period_start, property_type, metric_value AS homes_sold FROM redfin_homes_sold WHERE geo_type = 'city'   AND dh_state_name = 'Washington'   AND dh_place_name = 'Seattle'   AND (property_type = 'Single-family'       OR property_type = 'Condo/Co-op') ORDER BY period_start DESC LIMIT 2;", "SELECT period_end, property_type, metric_value AS homes_sold FROM redfin_homes_sold WHERE geo_type = 'city'   AND dh_state_name = 'Washington'   AND dh_place_name = 'Seattle'   AND (property_type = 'Single-family'       OR property_type = 'Condo/Co-op') ORDER BY period_end DESC LIMIT 2;", "WITH Seattle_data AS   (SELECT location_name, geo_type, property_type, metric_value AS homes_sold, period_start FROM redfin_homes_sold WHERE dh_state_name = 'Washington' AND dh_place_name = 'Seattle' AND property_type IN ('Single-family', 'Condo/Co-op') AND geo_type = 'city' AND period_start = (SELECT max(period_start) FROM redfin_homes_sold WHERE dh_state_name = 'Washington' AND dh_place_name = 'Seattle') ) SELECT cd.property_type, cd.homes_sold AS homes_sold FROM Seattle_data cd WHERE cd.property_type = 'Condo/Co-op' UNION ALL SELECT sf.property_type, sf.homes_sold AS homes_sold FROM Seattle_data sf WHERE sf.property_type = 'Single-family';" ] },
    { "question": "top 10 zip codes in the US with most condos sold in June 2023", "golden_sqls": [ "SELECT dh_zip_code, metric_value AS homes_sold FROM redfin_homes_sold WHERE geo_type = 'zip'   AND property_type = 'Condo/Co-op'   AND period_start = '2023-06-01' ORDER BY metric_value DESC LIMIT 10;", "SELECT dh_zip_code FROM redfin_homes_sold WHERE geo_type = 'zip'   AND property_type = 'Condo/Co-op'   AND period_start = '2023-06-01' ORDER BY metric_value DESC LIMIT 10;" ] },
    { "question": "houston home sales trends 2023", "golden_sqls": [ "SELECT period_start, metric_value AS homes_sold FROM redfin_homes_sold WHERE geo_type = 'city'   AND property_type = 'All Residential'   AND dh_state_name = 'Texas'   AND dh_place_name = 'Houston'   AND period_start BETWEEN '2023-01-01' AND '2023-12-31' ORDER BY period_start;", "SELECT period_end, metric_value AS homes_sold FROM redfin_homes_sold WHERE geo_type = 'city'   AND property_type = 'All Residential'   AND dh_state_name = 'Texas'   AND dh_place_name = 'Houston'   AND period_end BETWEEN '2023-01-01' AND '2023-12-31' ORDER BY period_end;" ] },
    { "question": "what was the median sale price of condos in top 10 cities with most condos sold in may 2023?", "golden_sqls": [ "WITH top_10_cities AS (  SELECT dh_state_name, dh_city_name, metric_value AS total_condos_sold  FROM redfin_homes_sold  WHERE geo_type = 'city'    AND property_type = 'Condo/Co-op'    AND period_start = '2023-05-01'  ORDER BY total_condos_sold DESC LIMIT 10 ) SELECT rmsp.dh_state_name, rmsp.dh_city_name, rmsp.metric_value AS median_sale_price FROM redfin_median_sale_price rmsp JOIN top_10_cities t10c    ON rmsp.dh_state_name = t10c.dh_state_name   AND rmsp.dh_city_name = t10c.dh_city_name WHERE geo_type = 'city'   AND property_type = 'Condo/Co-op'   AND period_start = '2023-05-01' ORDER BY t10c.total_condos_sold DESC;" ] },
    { "question": "homes sold by state with price per sqft: Jan-Jun 2023", "golden_sqls": [ "SELECT rmp.dh_state_name, rmp.period_start, rmp.metric_value AS median_sale_price, hs.metric_value AS homes_sold FROM redfin_median_ppsf rmp JOIN redfin_homes_sold hs    ON rmp.dh_state_name = hs.dh_state_name   AND rmp.period_start = hs.period_start   AND rmp.geo_type = hs.geo_type   AND rmp.property_type = hs.property_type WHERE rmp.geo_type = 'state'   AND rmp.property_type = 'All Residential'   AND rmp.period_start >= '2023-01-01'   AND rmp.period_end <= '2023-06-30' ORDER BY rmp.dh_state_name, rmp.period_start;", "SELECT rmp.dh_state_name, rmp.period_end, rmp.metric_value AS median_sale_price, hs.metric_value AS homes_sold FROM redfin_median_ppsf rmp JOIN redfin_homes_sold hs    ON rmp.dh_state_name = hs.dh_state_name   AND rmp.period_end = hs.period_end   AND rmp.geo_type = hs.geo_type   AND rmp.property_type = hs.property_type WHERE rmp.geo_type = 'state'   AND rmp.property_type = 'All Residential'   AND rmp.period_start >= '2023-01-01'   AND rmp.period_end <= '2023-06-30' ORDER BY rmp.dh_state_name, rmp.period_end;" ] },
    { "question": "top 10 counties with the highest discrepancy between single family listing price and sales price in November 2022", "golden_sqls": [ "WITH SingleFamily_ListingData AS (  SELECT dh_state_name, dh_county_fullname, metric_value AS median_listing_price  FROM redfin_median_list_price  WHERE geo_type = 'county'    AND property_type = 'Single-family'    AND period_end = '2022-11-30'), SingleFamily_SalesData AS (  SELECT dh_state_name, dh_county_fullname, metric_value AS median_sales_price  FROM redfin_median_sale_price  WHERE geo_type = 'county'    AND property_type = 'Single-family'    AND period_end = '2022-11-30') SELECT ld.dh_state_name, ld.dh_county_fullname, ld.median_listing_price, sd.median_sales_price,  abs(ld.median_listing_price - sd.median_sales_price) AS price_discrepancy FROM SingleFamily_ListingData ld JOIN SingleFamily_SalesData sd   ON ld.dh_state_name = sd.dh_state_name  AND ld.dh_county_fullname = sd.dh_county_fullname ORDER BY price_discrepancy DESC LIMIT 10;" ] },
    { "question": "price per square foot of cities with most expensive rents: jan-dec 2022", "golden_sqls": [ "WITH top_10_cities AS (  SELECT dh_state_name, dh_city_name, metric_value AS median_rent  FROM renthub_median_rent  WHERE geo_type = 'city'    AND property_type = 'All Residential'    AND period_start = '2022-12-01'  ORDER BY median_rent DESC LIMIT 10 ) SELECT rmp.period_start, t10c.dh_state_name, t10c.dh_city_name, rmp.metric_value AS median_ppsf FROM top_10_cities t10c LEFT JOIN redfin_median_ppsf rmp   ON t10c.dh_state_name = rmp.dh_state_name  AND t10c.dh_city_name = rmp.dh_city_name WHERE geo_type = 'city'   AND property_type = 'All Residential'   AND period_start BETWEEN '2023-01-01' AND '2023-12-31' ORDER BY period_start, t10c.median_rent DESC;", "WITH top_10_cities AS (  SELECT dh_state_name, dh_city_name, metric_value AS median_rent  FROM renthub_median_rent  WHERE geo_type = 'city'    AND property_type = 'All Residential'    AND period_start = '2022-12-01'  ORDER BY median_rent DESC LIMIT 10 ) SELECT rmp.period_end, t10c.dh_state_name, t10c.dh_city_name, rmp.metric_value AS median_ppsf FROM top_10_cities t10c LEFT JOIN redfin_median_ppsf rmp   ON t10c.dh_state_name = rmp.dh_state_name  AND t10c.dh_city_name = rmp.dh_city_name WHERE geo_type = 'city'   AND property_type = 'All Residential'   AND period_end BETWEEN '2023-01-01' AND '2023-12-31' ORDER BY period_end, t10c.median_rent DESC;" ] },
    { "question": "county with highest increase in list price over the past year", "golden_sqls": [ "WITH date_range AS (     SELECT          max(period_end) AS new_date,          (max(period_end) - interval '1 year')::date AS old_date     FROM redfin_median_list_price     WHERE geo_type = 'county'     AND property_type = 'All Residential' ), DATA AS (     SELECT period_end, dh_state_name, dh_county_name, metric_value AS list_price     FROM redfin_median_list_price     WHERE geo_type = 'county'     AND property_type = 'All Residential'     AND (period_end = (SELECT new_date FROM date_range) OR period_end = (SELECT old_date FROM date_range)) ) SELECT cd.dh_state_name, cd.dh_county_name, cd.list_price AS new_list_price, ld.list_price AS old_list_price,     (cd.list_price - ld.list_price) AS total_increase, (cd.list_price - ld.list_price) * 100 / ld.list_price AS pct_increase FROM DATA cd JOIN DATA ld ON cd.dh_state_name = ld.dh_state_name AND cd.dh_county_name = ld.dh_county_name WHERE cd.period_end = (SELECT new_date FROM date_range) AND ld.period_end = (SELECT old_date FROM date_range) ORDER BY total_increase DESC LIMIT 1;", "WITH date_range AS (     SELECT          max(period_end) AS new_date,          (max(period_end) - interval '1 year')::date AS old_date     FROM redfin_median_list_price     WHERE geo_type = 'county'     AND property_type = 'All Residential' ), DATA AS (     SELECT period_end, dh_state_name, dh_county_name, metric_value AS list_price     FROM redfin_median_list_price     WHERE geo_type = 'county'     AND property_type = 'All Residential'     AND (period_end = (SELECT new_date FROM date_range) OR period_end = (SELECT old_date FROM date_range)) ) SELECT cd.dh_state_name, cd.dh_county_name, cd.list_price AS new_list_price, ld.list_price AS old_list_price,     (cd.list_price - ld.list_price) AS total_increase, (cd.list_price - ld.list_price) * 100 / ld.list_price AS pct_increase FROM DATA cd JOIN DATA ld ON cd.dh_state_name = ld.dh_state_name AND cd.dh_county_name = ld.dh_county_name WHERE cd.period_end = (SELECT new_date FROM date_range) AND ld.period_end = (SELECT old_date FROM date_range) ORDER BY pct_increase DESC LIMIT 1;" ] },
    { "question": "How much does list price vary among different property types in 94582?", "golden_sqls": [ "SELECT property_type,  min(metric_value) AS min_price, max(metric_value) AS max_price,  max(metric_value) - min(metric_value) AS price_diff FROM redfin_median_list_price WHERE dh_zip_code = '94582'   AND geo_type = 'zip'   AND property_type <> 'All Residential' GROUP BY property_type ORDER BY property_type;" ] },
    { "question": "Did the list price of townhouses increase in the last three months in Los Angeles?", "golden_sqls": [ "WITH date_range AS (     SELECT max(period_start) AS new_date,            (max(period_start) - interval '3 months')::date AS old_date     FROM redfin_median_list_price     WHERE geo_type = 'city'       AND property_type = 'Townhouse'       AND dh_state_name = 'California'       AND dh_city_name = 'Los Angeles' ), DATA AS (     SELECT period_start, metric_value AS median_price     FROM redfin_median_list_price     WHERE geo_type = 'city'       AND property_type = 'Townhouse'       AND dh_state_name = 'California'       AND dh_city_name = 'Los Angeles'       AND (period_start = (SELECT new_date FROM date_range)         OR period_start = (SELECT old_date FROM date_range)) ) SELECT ld.median_price AS old_list_price, cd.median_price AS new_list_price FROM DATA ld, DATA cd WHERE ld.period_start = (SELECT old_date FROM date_range)   AND cd.period_start = (SELECT new_date FROM date_range)", "WITH date_range AS (     SELECT max(period_start) AS new_date,            (max(period_start) - interval '3 months')::date AS old_date     FROM redfin_median_list_price     WHERE geo_type = 'city'       AND property_type = 'Townhouse'       AND dh_state_name = 'California'       AND dh_city_name = 'Los Angeles' ) SELECT period_start, metric_value AS median_price FROM redfin_median_list_price WHERE geo_type = 'city'   AND property_type = 'Townhouse'   AND dh_state_name = 'California'   AND dh_city_name = 'Los Angeles'   AND (period_start = (SELECT new_date FROM date_range)     OR period_start = (SELECT old_date FROM date_range));"] },
    { "question": "Did list price of condos increase more than single-family homes in MA?", "golden_sqls": [ "WITH condos_data AS (  SELECT period_end, location_name, metric_value AS median_price  FROM redfin_median_list_price  WHERE geo_type = 'state'    AND property_type = 'Condo/Co-op'    AND dh_state_name = 'Massachusetts'  ORDER BY period_end DESC LIMIT 2), single_family_data AS (  SELECT period_end, location_name, metric_value AS median_price  FROM redfin_median_list_price  WHERE geo_type = 'state'    AND property_type = 'Single-family'    AND dh_state_name = 'Massachusetts'  ORDER BY period_end DESC LIMIT 2) SELECT cd.period_end, cd.median_price AS condos_median_price, sfd.median_price AS single_family_median_price FROM condos_data cd JOIN single_family_data sfd   ON cd.period_end = sfd.period_end ORDER BY cd.period_end DESC;", "WITH condos_data AS (  SELECT period_start, location_name, metric_value AS median_price  FROM redfin_median_list_price  WHERE geo_type = 'state'    AND property_type = 'Condo/Co-op'    AND dh_state_name = 'Massachusetts'  ORDER BY period_start DESC LIMIT 2), single_family_data AS (  SELECT period_start, location_name, metric_value AS median_price  FROM redfin_median_list_price  WHERE geo_type = 'state'    AND property_type = 'Single-family'    AND dh_state_name = 'Massachusetts'  ORDER BY period_start DESC LIMIT 2) SELECT cd.period_start, cd.median_price AS condos_median_price, sfd.median_price AS single_family_median_price FROM condos_data cd JOIN single_family_data sfd   ON cd.period_end = sfd.period_end ORDER BY cd.period_start DESC;", "WITH condos_data AS (  SELECT period_end, location_name, metric_value AS median_price  FROM redfin_median_list_price  WHERE geo_type = 'state'    AND property_type = 'Condo/Co-op'    AND dh_state_name = 'Massachusetts'  ORDER BY period_end DESC LIMIT 2), single_family_data AS (  SELECT period_end, location_name, metric_value AS median_price  FROM redfin_median_list_price  WHERE geo_type = 'state'    AND property_type = 'Single-family'    AND dh_state_name = 'Massachusetts'  ORDER BY period_end DESC LIMIT 2) SELECT cd.period_end,  ABS(cd.median_price - LAG(cd.median_price) OVER (ORDER BY cd.period_end ASC)) AS condos_price_change,  ABS(sfd.median_price - LAG(sfd.median_price) OVER (ORDER BY sfd.period_end ASC)) AS single_price_change FROM condos_data cd JOIN single_family_data sfd   ON cd.period_end = sfd.period_end ORDER BY cd.period_end DESC LIMIT 1;", "WITH condos_data AS (  SELECT period_start, location_name, metric_value AS median_price  FROM redfin_median_list_price  WHERE geo_type = 'state'    AND property_type = 'Condo/Co-op'    AND dh_state_name = 'Massachusetts'  ORDER BY period_start DESC LIMIT 2), single_family_data AS (  SELECT period_start, location_name, metric_value AS median_price  FROM redfin_median_list_price  WHERE geo_type = 'state'    AND property_type = 'Single-family'    AND dh_state_name = 'Massachusetts'  ORDER BY period_start DESC LIMIT 2) SELECT cd.period_start,  ABS(cd.median_price - LAG(cd.median_price) OVER (ORDER BY cd.period_start ASC)) AS condos_price_change,  ABS(sfd.median_price - LAG(sfd.median_price) OVER (ORDER BY sfd.period_start ASC)) AS single_price_change FROM condos_data cd JOIN single_family_data sfd   ON cd.period_start = sfd.period_start ORDER BY cd.period_start DESC LIMIT 1;" ] },
    { "question": "list price by property type in Kansas City", "golden_sqls": [ "SELECT property_type,        metric_value AS median_price FROM redfin_median_list_price WHERE geo_type = 'city'   AND dh_state_name = 'Missouri'   AND dh_place_name = 'Kansas City'   AND property_type <> 'All Residential'   AND period_end =     (SELECT max(period_end)      FROM redfin_median_list_price      WHERE geo_type = 'city'        AND dh_state_name = 'Missouri'        AND dh_place_name = 'Kansas City') ORDER BY property_type ASC;", "SELECT period_start,        property_type,        metric_value AS median_price FROM redfin_median_list_price WHERE geo_type = 'city'   AND dh_state_name = 'Missouri'   AND dh_place_name = 'Kansas City'   AND property_type <> 'All Residential' ORDER BY period_start DESC, property_type;", "SELECT period_end,        property_type,        metric_value AS median_price FROM redfin_median_list_price WHERE geo_type = 'city'   AND dh_state_name = 'Missouri'   AND dh_place_name = 'Kansas City'   AND property_type <> 'All Residential' ORDER BY period_end DESC, property_type;" ] },
    { "question": "How many condos are on sale in Raleigh, NC currently?", "golden_sqls": [ "SELECT period_start, metric_value AS inventory FROM redfin_inventory WHERE geo_type = 'city'   AND property_type = 'Condo/Co-op'   AND dh_state_name = 'North Carolina'   AND dh_place_name = 'Raleigh' ORDER BY period_start DESC LIMIT 1;", "SELECT period_end, metric_value AS inventory FROM redfin_inventory WHERE geo_type = 'city'   AND property_type = 'Condo/Co-op'   AND dh_state_name = 'North Carolina'   AND dh_place_name = 'Raleigh' ORDER BY period_end DESC LIMIT 1;", "SELECT metric_value AS inventory FROM redfin_inventory WHERE geo_type = 'city'   AND property_type = 'Condo/Co-op'   AND dh_state_name = 'North Carolina'   AND dh_place_name = 'Raleigh' ORDER BY period_end DESC LIMIT 1;" ] },
    { "question": "NV ZIP code with largest change in available single-family homes?", "golden_sqls": [ "WITH date_range AS (     SELECT max(period_end) AS new_date,            (max(period_end) - interval '1 month')::date AS old_date     FROM redfin_inventory     WHERE geo_type = 'zip'       AND property_type = 'Single-family'       AND dh_state_name = 'Nevada' ), inventory_data AS (     SELECT location_name, metric_value AS inventory, period_end     FROM redfin_inventory     WHERE geo_type = 'zip'       AND property_type = 'Single-family'       AND dh_state_name = 'Nevada'       AND (period_end = (SELECT new_date FROM date_range) OR period_end = (SELECT old_date FROM date_range)) ) SELECT cd.location_name AS zip_code,        cd.inventory AS new_inventory,        ld.inventory AS old_inventory,        abs(cd.inventory - ld.inventory) AS change_in_inventory FROM inventory_data cd JOIN inventory_data ld ON cd.location_name = ld.location_name WHERE cd.period_end = (SELECT new_date FROM date_range)   AND ld.period_end = (SELECT old_date FROM date_range) ORDER BY change_in_inventory DESC LIMIT 1;", "WITH date_range AS (     SELECT max(period_end) AS new_date,            (max(period_end) - interval '1 month')::date AS old_date     FROM redfin_inventory     WHERE geo_type = 'zip'       AND property_type = 'Single-family'       AND dh_state_name = 'Nevada' ), inventory_data AS (     SELECT location_name, metric_value AS inventory, period_end     FROM redfin_inventory     WHERE geo_type = 'zip'       AND property_type = 'Single-family'       AND dh_state_name = 'Nevada'       AND (period_end = (SELECT new_date FROM date_range) OR period_end = (SELECT old_date FROM date_range)) ) SELECT cd.location_name AS zip_code,        abs(cd.inventory - ld.inventory) AS change_in_inventory FROM inventory_data cd JOIN inventory_data ld ON cd.location_name = ld.location_name WHERE cd.period_end = (SELECT new_date FROM date_range)   AND ld.period_end = (SELECT old_date FROM date_range) ORDER BY change_in_inventory DESC LIMIT 1;" ] },
    { "question": "Did the number of available houses increase or decrease in Orlando?", "golden_sqls": [ "SELECT period_end,        metric_value AS inventory FROM redfin_inventory WHERE geo_type = 'city'   AND property_type = 'All Residential'   AND dh_state_name = 'Florida'   AND dh_place_name = 'Orlando' ORDER BY period_end DESC LIMIT 13;", "SELECT period_start,        metric_value AS inventory FROM redfin_inventory WHERE geo_type = 'city'   AND property_type = 'All Residential'   AND dh_state_name = 'Florida'   AND dh_place_name = 'Orlando' ORDER BY period_start DESC LIMIT 13;" ] },
    { "question": "number of townhouses on sale in Kansas", "golden_sqls": [ "SELECT period_start,        metric_value AS inventory FROM redfin_inventory WHERE geo_type = 'state'   AND property_type = 'Townhouse'   AND dh_state_name = 'Kansas' ORDER BY period_start DESC LIMIT 1;", "SELECT period_end,        metric_value AS inventory FROM redfin_inventory WHERE geo_type = 'state'   AND property_type = 'Townhouse'   AND dh_state_name = 'Kansas' ORDER BY period_end DESC LIMIT 1;", "SELECT metric_value AS inventory FROM redfin_inventory WHERE geo_type = 'state'   AND property_type = 'Townhouse'   AND dh_state_name = 'Kansas' ORDER BY period_start DESC LIMIT 1;" ] },
    { "question": "Are there more condos or townhouses on sale in Portland?", "golden_sqls": [ "SELECT period_start, property_type, metric_value AS inventory FROM redfin_inventory WHERE geo_type = 'city'   AND (property_type = 'Condo/Co-op'     OR property_type = 'Townhouse')   AND dh_state_name = 'Oregon'   AND dh_place_name = 'Portland'   ORDER BY period_start DESC LIMIT 2;", "SELECT period_end, property_type, metric_value AS inventory FROM redfin_inventory WHERE geo_type = 'city'   AND (property_type = 'Condo/Co-op'     OR property_type = 'Townhouse')   AND dh_state_name = 'Oregon'   AND dh_place_name = 'Portland'   ORDER BY period_end DESC LIMIT 2;", "SELECT property_type, metric_value AS inventory FROM redfin_inventory WHERE geo_type = 'city'   AND (property_type = 'Condo/Co-op'     OR property_type = 'Townhouse')   AND dh_state_name = 'Oregon'   AND dh_place_name = 'Portland'   ORDER BY period_start DESC LIMIT 2;", "WITH condo_data AS (  SELECT period_start, metric_value AS condo_inventory  FROM redfin_inventory  WHERE geo_type = 'city'    AND property_type = 'Condo/Co-op'    AND dh_state_name = 'Oregon'    AND dh_place_name = 'Portland'  ORDER BY period_start DESC LIMIT 1 ), townhouse_data AS (  SELECT period_start, metric_value AS townhouse_inventory  FROM redfin_inventory  WHERE geo_type = 'city'    AND property_type = 'Townhouse'    AND dh_state_name = 'Oregon'    AND dh_place_name = 'Portland'  ORDER BY period_start DESC LIMIT 1 ) SELECT cd.period_start, condo_inventory, townhouse_inventory FROM condo_data cd JOIN townhouse_data td ON cd.period_start = td.period_start;", "WITH condo_data AS (  SELECT period_end, metric_value AS condo_inventory  FROM redfin_inventory  WHERE geo_type = 'city'    AND property_type = 'Condo/Co-op'    AND dh_state_name = 'Oregon'    AND dh_place_name = 'Portland'  ORDER BY period_end DESC LIMIT 1 ), townhouse_data AS (  SELECT period_end, metric_value AS townhouse_inventory  FROM redfin_inventory  WHERE geo_type = 'city'    AND property_type = 'Townhouse'    AND dh_state_name = 'Oregon'    AND dh_place_name = 'Portland'  ORDER BY period_end DESC LIMIT 1 ) SELECT cd.period_end, condo_inventory, townhouse_inventory FROM condo_data cd JOIN townhouse_data td ON cd.period_end = td.period_end;" ] },
    { "question": "houses put on the market over the past three months in Iowa", "golden_sqls": [ "SELECT period_start,        metric_value AS new_listings FROM redfin_new_listings WHERE geo_type = 'state'   AND property_type = 'All Residential'   AND dh_state_name = 'Iowa' ORDER BY period_start DESC LIMIT 3;" ] },
    { "question": "How many condos were put up for sale in Boston, MA?", "golden_sqls": [ "SELECT period_end,        metric_value AS new_listings FROM redfin_new_listings WHERE geo_type = 'city'   AND property_type = 'Condo/Co-op'   AND dh_state_name = 'Massachusetts'   AND dh_place_name = 'Boston' ORDER BY period_end DESC LIMIT 1;", "SELECT period_start,        metric_value AS new_listings FROM redfin_new_listings WHERE geo_type = 'city'   AND property_type = 'Condo/Co-op'   AND dh_state_name = 'Massachusetts'   AND dh_place_name = 'Boston' ORDER BY period_start DESC LIMIT 1;", "SELECT metric_value AS new_listings FROM redfin_new_listings WHERE geo_type = 'city'   AND property_type = 'Condo/Co-op'   AND dh_state_name = 'Massachusetts'   AND dh_place_name = 'Boston' ORDER BY period_end DESC LIMIT 1;" ] },
    { "question": "% change in new listings over the last year nationally", "golden_sqls": [ "WITH DATA AS   (SELECT metric_value AS new_listings,           period_start    FROM redfin_new_listings    WHERE geo_type = 'national'      AND property_type = 'All Residential'      AND is_seasonally_adjusted = FALSE      AND period_start >=        (SELECT max(period_start) - interval '1 year'         FROM redfin_new_listings         WHERE geo_type = 'national'           AND property_type = 'All Residential'           AND is_seasonally_adjusted = FALSE) ) SELECT cd.new_listings AS new_new_listings,        ld.new_listings AS old_new_listings,        ((cd.new_listings - ld.new_listings) * 100 / ld.new_listings) AS pct_change FROM DATA cd, DATA ld WHERE cd.period_start = (SELECT max(period_start) FROM DATA)   AND ld.period_start = (SELECT min(period_start) FROM DATA);", "WITH DATA AS   (SELECT metric_value AS new_listings,           period_start    FROM redfin_new_listings    WHERE geo_type = 'national'      AND property_type = 'All Residential'      AND is_seasonally_adjusted = FALSE      AND period_start >=        (SELECT max(period_start) - interval '1 year'         FROM redfin_new_listings         WHERE geo_type = 'national'           AND property_type = 'All Residential'           AND is_seasonally_adjusted = FALSE) ) SELECT ((cd.new_listings - ld.new_listings) * 100 / ld.new_listings) AS pct_change FROM DATA cd, DATA ld WHERE cd.period_start = (SELECT max(period_start) FROM DATA)   AND ld.period_start = (SELECT min(period_start) FROM DATA);" ] },
    { "question": "new listings by property type in NM", "golden_sqls": [ "SELECT property_type, metric_value AS new_listings FROM redfin_new_listings WHERE geo_type = 'state'   AND dh_state_name = 'New Mexico'   AND property_type <> 'All Residential'   AND period_start = (SELECT max(period_start) FROM redfin_new_listings WHERE geo_type = 'state' AND dh_state_name = 'New Mexico') ORDER BY metric_value DESC;", "SELECT period_start, property_type, metric_value AS new_listings FROM redfin_new_listings WHERE geo_type = 'state'   AND dh_state_name = 'New Mexico'   AND property_type <> 'All Residential' ORDER BY period_start DESC, property_type;", "SELECT period_end, property_type, metric_value AS new_listings FROM redfin_new_listings WHERE geo_type = 'state'   AND dh_state_name = 'New Mexico'   AND property_type <> 'All Residential' ORDER BY period_end DESC, property_type;" ] },
    { "question": "which month had the lowest number of new listings?", "golden_sqls": [ "SELECT period_start,        metric_value AS new_listings FROM redfin_new_listings WHERE geo_type = 'national'   AND is_seasonally_adjusted = False   AND property_type = 'All Residential' ORDER BY metric_value ASC LIMIT 1;", "SELECT period_end,        metric_value AS new_listings FROM redfin_new_listings WHERE geo_type = 'national'   AND is_seasonally_adjusted = False   AND property_type = 'All Residential' ORDER BY metric_value ASC LIMIT 1;", "SELECT period_start FROM redfin_new_listings WHERE geo_type = 'national'   AND is_seasonally_adjusted = False   AND property_type = 'All Residential' ORDER BY metric_value ASC LIMIT 1;", "SELECT period_end FROM redfin_new_listings WHERE geo_type = 'national'   AND is_seasonally_adjusted = False   AND property_type = 'All Residential' ORDER BY metric_value ASC LIMIT 1;" ] },
    { "question": "How does list price compare to sale price in Maryland?", "golden_sqls": [ "WITH list_price_data AS   (SELECT period_end,           metric_value AS median_list_price    FROM redfin_median_list_price    WHERE geo_type = 'state'      AND property_type = 'All Residential'      AND dh_state_name = 'Maryland'    ORDER BY period_end DESC),      sale_price_data AS   (SELECT period_end,           metric_value AS median_sale_price    FROM redfin_median_sale_price    WHERE geo_type = 'state'      AND property_type = 'All Residential'      AND dh_state_name = 'Maryland'    ORDER BY period_end DESC) SELECT lp.period_end,        lp.median_list_price,        sp.median_sale_price,        ((sp.median_sale_price - lp.median_list_price) * 100 / lp.median_list_price) AS pct_diff FROM list_price_data lp JOIN sale_price_data sp ON lp.period_end = sp.period_end ORDER BY lp.period_end DESC LIMIT 5;", "WITH list_price_data AS   (SELECT period_start,           metric_value AS median_list_price    FROM redfin_median_list_price    WHERE geo_type = 'state'      AND property_type = 'All Residential'      AND dh_state_name = 'Maryland'    ORDER BY period_start DESC),      sale_price_data AS   (SELECT period_start,           metric_value AS median_sale_price    FROM redfin_median_sale_price    WHERE geo_type = 'state'      AND property_type = 'All Residential'      AND dh_state_name = 'Maryland'    ORDER BY period_start DESC) SELECT lp.period_start,        lp.median_list_price,        sp.median_sale_price,        ((sp.median_sale_price - lp.median_list_price) * 100 / lp.median_list_price) AS pct_diff FROM list_price_data lp JOIN sale_price_data sp ON lp.period_start = sp.period_start ORDER BY lp.period_start DESC LIMIT 5;", "WITH list_price_data AS   (SELECT period_end,       'list price' AS metric,           metric_value    FROM redfin_median_list_price    WHERE geo_type = 'state'      AND property_type = 'All Residential'      AND dh_state_name = 'Maryland'    ORDER BY period_end DESC),      sale_price_data AS   (SELECT period_end,           'sale price' AS metric,           metric_value    FROM redfin_median_sale_price    WHERE geo_type = 'state'      AND property_type = 'All Residential'      AND dh_state_name = 'Maryland'    ORDER BY period_end DESC) SELECT period_end, metric, metric_value FROM list_price_data UNION SELECT period_end, metric, metric_value FROM sale_price_data ORDER BY period_end DESC, metric LIMIT 10;", "WITH list_price_data AS   (SELECT period_start,       'list price' AS metric,           metric_value    FROM redfin_median_list_price    WHERE geo_type = 'state'      AND property_type = 'All Residential'      AND dh_state_name = 'Maryland'    ORDER BY period_start DESC),      sale_price_data AS   (SELECT period_start,           'sale price' AS metric,           metric_value    FROM redfin_median_sale_price    WHERE geo_type = 'state'      AND property_type = 'All Residential'      AND dh_state_name = 'Maryland'    ORDER BY period_start DESC) SELECT period_start, metric, metric_value FROM list_price_data UNION SELECT period_start, metric, metric_value FROM sale_price_data ORDER BY period_start DESC, metric LIMIT 10;" ] },
    { "question": "How many properties were put on the market in CA this past month? Compare to the total inventory", "golden_sqls": [ "WITH new_listings_data AS (SELECT period_start, metric_value AS new_listings FROM redfin_new_listings WHERE geo_type = 'state' AND property_type = 'All Residential' AND dh_state_name = 'California' ORDER BY period_start DESC LIMIT 1), inventory_data AS (SELECT period_start, metric_value AS inventory FROM redfin_inventory WHERE geo_type = 'state' AND property_type = 'All Residential' AND dh_state_name = 'California' ORDER BY period_start DESC LIMIT 1) SELECT nld.period_start, new_listings, inventory FROM new_listings_data nld JOIN inventory_data id ON nld.period_start = id.period_start;", "WITH new_listings_data AS (SELECT period_start, 'new_listings' AS metric, metric_value FROM redfin_new_listings WHERE geo_type = 'state' AND property_type = 'All Residential' AND dh_state_name = 'California' ORDER BY period_start DESC LIMIT 1), inventory_data AS (SELECT period_start, 'inventory' AS metric, metric_value FROM redfin_inventory WHERE geo_type = 'state' AND property_type = 'All Residential' AND dh_state_name = 'California' ORDER BY period_start DESC LIMIT 1) SELECT period_start, metric, metric_value FROM new_listings_data UNION SELECT period_start, metric, metric_value FROM inventory_data;" ] }
]